<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="en">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta name="description" content="概述React是由Facebook主导开发的JavaScript框架，和之前流行过的MVVM框架例如Angular不同，Reac只专注MVC中的V（视图层），优点在于轻、块、并且组件化的思想在构建开发用户界面时有很大的帮助。React规范化的代码风格，能减少每个开发者开发出来的代码风格的差异，在团队协作中益处显著。 前置知识  JavaScript基础（变量／对象／函数） ES6 基础 熟悉 HT">
<meta property="og:type" content="article">
<meta property="og:title" content="react">
<meta property="og:url" content="https://zhuayu.github.io/zhuayu.github.io/2017/10/16/react/index.html">
<meta property="og:site_name" content="JaxChu">
<meta property="og:description" content="概述React是由Facebook主导开发的JavaScript框架，和之前流行过的MVVM框架例如Angular不同，Reac只专注MVC中的V（视图层），优点在于轻、块、并且组件化的思想在构建开发用户界面时有很大的帮助。React规范化的代码风格，能减少每个开发者开发出来的代码风格的差异，在团队协作中益处显著。 前置知识  JavaScript基础（变量／对象／函数） ES6 基础 熟悉 HT">
<meta property="og:locale" content="en">
<meta property="og:updated_time" content="2017-10-15T08:27:04.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="react">
<meta name="twitter:description" content="概述React是由Facebook主导开发的JavaScript框架，和之前流行过的MVVM框架例如Angular不同，Reac只专注MVC中的V（视图层），优点在于轻、块、并且组件化的思想在构建开发用户界面时有很大的帮助。React规范化的代码风格，能减少每个开发者开发出来的代码风格的差异，在团队协作中益处显著。 前置知识  JavaScript基础（变量／对象／函数） ES6 基础 熟悉 HT">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.3',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://zhuayu.github.io/zhuayu.github.io/2017/10/16/react/"/>





  <title>react | JaxChu</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">JaxChu</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">Quick note</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            About
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="st-search-show-outputs">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            Search
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <form class="site-search-form">
  <input type="text" id="st-search-input" class="st-search-input st-default-search-input" />
</form>

<script type="text/javascript">
  (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
    (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
    e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
  })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

  _st('install', 'U5nsiDF5pEyJZwgfAFT5','2.0.0');
</script>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://zhuayu.github.io/zhuayu.github.io/2017/10/16/react/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="JaxChu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="JaxChu">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">react</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-10-16T00:23:15+08:00">
                2017-10-15
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><p>React是由Facebook主导开发的JavaScript框架，和之前流行过的MVVM框架例如Angular不同，Reac只专注MVC中的V（视图层），优点在于轻、块、并且组件化的思想在构建开发用户界面时有很大的帮助。React规范化的代码风格，能减少每个开发者开发出来的代码风格的差异，在团队协作中益处显著。</p>
<p>前置知识</p>
<ul>
<li>JavaScript基础（变量／对象／函数）</li>
<li>ES6 基础</li>
<li>熟悉 HTML</li>
<li>基本掌握 CSS</li>
</ul>
<p>参考文档</p>
<ul>
<li><a href="https://facebook.github.io/react/docs/hello-world.html" target="_blank" rel="external">react官网</a><a id="more"></a>
</li>
</ul>
<h2 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h2><p><a href="https://nodejs.org/zh-cn/" target="_blank" rel="external">node</a> 环境下载安装，如网速较慢可尝试 <a href="https://yarnpkg.com/zh-Hans/" target="_blank" rel="external">yarn</a> 或切换 <a href="http://npm.taobao.org/" target="_blank" rel="external">淘宝镜像</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">npm install -g create-react-app</div><div class="line">create-react-app my-app</div><div class="line"></div><div class="line"><span class="built_in">cd</span> my-app</div><div class="line">npm start</div></pre></td></tr></table></figure>
<h2 id="组建开发"><a href="#组建开发" class="headerlink" title="组建开发"></a>组建开发</h2><h3 id="JSX入门"><a href="#JSX入门" class="headerlink" title="JSX入门"></a>JSX入门</h3><p>JSX是基于JavaScript在React当中的一种语法扩展，不是单纯的字符串，不是模版语言，也不是HTML。被用于创建React当中的Element，通过React当中的方法渲染成DOM。</p>
<p>采用JSX及ES6语法的js代码需要转移才能在浏览器中运行，实际生产中会利用BABEL之类的转译器，转译成浏览器可以直接运行的js。JSX在转移过程中，会变成React.creatElement的一个方法，其中的标签语言都会被转化为参数传入 。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//JSX</span></div><div class="line">ReactDOM.render(</div><div class="line">    &lt;p&gt;Hello world!&lt;/p&gt;,</div><div class="line">    <span class="built_in">document</span>.getElementById(<span class="string">'container'</span>)</div><div class="line">)</div><div class="line"><span class="comment">//BABEL</span></div><div class="line">React.createElement(<span class="string">'p'</span>,<span class="literal">null</span>,<span class="string">`Hello world!`</span>),</div><div class="line">    <span class="built_in">document</span>.getElementById(<span class="string">'container'</span>)</div><div class="line">)</div></pre></td></tr></table></figure>
<p>用JSX创建的元素一般情况下都是不可变的，所以一般采用const关键字来声明一个JSX元素。（ const 关键字在ES6中被用来声明一个常量，但这里所谓的常量和其他编程语言中的概念稍有不同，它事实上是声明一个只读的指针。 </p>
<p>JSX中的标签可以携带属性，例如我们可以添加id，但是和HTML又不是完全相同，为标签使用class的时候需要添加className。JSX支持的所有属性可以在这里找到：<a href="https://facebook.github.io/react/docs/dom-elements.html#all-supported-html-attributes" target="_blank" rel="external">All Supported HTML Attributes</a></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'reat'</span></div><div class="line"><span class="keyword">import</span> ReactDOM <span class="keyword">from</span> <span class="string">'react-dom'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> title = <span class="string">`&lt;h1 id="appTitle" className="h1-title"&gt;React Learning&lt;/h1&gt;`</span>;</div><div class="line">ReactDOM.render(title,<span class="built_in">document</span>.getElementById(<span class="string">'root'</span>);</div></pre></td></tr></table></figure>
<p>JSX的标签可以相互嵌套，但嵌套时最外层有且只能有一个标签。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'reat'</span></div><div class="line"><span class="keyword">import</span> ReactDOM <span class="keyword">from</span> <span class="string">'react-dom'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> title = (</div><div class="line">    &lt;div&gt;</div><div class="line">        &lt;h1 id=<span class="string">"appTitle"</span> className=<span class="string">"h1-title"</span>&gt;React Learning&lt;<span class="regexp">/h1&gt;</span></div><div class="line"><span class="regexp">        &lt;p&gt;lets learn JSX&lt;/</span>p&gt;</div><div class="line">    &lt;<span class="regexp">/div&gt;</span></div><div class="line"><span class="regexp">);</span></div><div class="line"><span class="regexp">ReactDOM.render(title,document.getElementById('root');</span></div></pre></td></tr></table></figure>
<p>JSX创建的元素中可以使用js表达式，表达式需要用大括号{}括起来。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'reat'</span></div><div class="line"><span class="keyword">import</span> ReactDOM <span class="keyword">from</span> <span class="string">'react-dom'</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">sayhi</span>(<span class="params">name</span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="string">`Hi , <span class="subst">$&#123;name&#125;</span>`</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> title = (</div><div class="line">    &lt;div&gt;</div><div class="line">        &lt;h1 id=<span class="string">"appTitle"</span> className=<span class="string">"h1-title"</span>&gt;React Learning&lt;<span class="regexp">/h1&gt;</span></div><div class="line"><span class="regexp">        &lt;p&gt;&#123;sayhi('react')&#125;&lt;/</span>p&gt;</div><div class="line">    &lt;<span class="regexp">/div&gt;</span></div><div class="line"><span class="regexp">);</span></div><div class="line"><span class="regexp">ReactDOM.render(title,document.getElementById('root');</span></div></pre></td></tr></table></figure>
<p>小结：</p>
<ul>
<li>JSX是React当中实现的一种扩展语法</li>
<li>JSX既不是字符串也不是HTML</li>
<li>通过JSX可以方便的在React中声明元素</li>
<li>JSX可以通过React当中的方法被渲染成页面的DOM</li>
<li>JSX的标签可以拥有属性，但与HTML不完全相同</li>
<li>JSX的标签也可以像HTML一样相互嵌套，但最外层只能有一个标签</li>
<li>我们可以在JSX当中使用JS表达式</li>
</ul>
<h3 id="组件"><a href="#组件" class="headerlink" title="组件"></a>组件</h3><h4 id="元素与组件-Element-amp-Component"><a href="#元素与组件-Element-amp-Component" class="headerlink" title="元素与组件 Element &amp; Component"></a>元素与组件 Element &amp; Component</h4><h5 id="React元素"><a href="#React元素" class="headerlink" title="React元素"></a>React元素</h5><p>元素是构建React应用的描述界面的最小单位，在作用上，我们可以把React元素理解为DOM元素，但实际中，React元素只是js中普通的对象。在React内部有一套React DOM的机制，我们可以称之为Virtual DOM，通过js中树状结构的对象来模拟真实DOM。<br>React之所以轻和快就是因为这虚拟DOM的存在，React内部还实行了一个低复杂度高效率的Diff算法。不同于以往的框架如Angular使用的脏检查，在应用改版数据的时候，React会尽量进行少的比较，然后更具虚拟DOM只改变真实DOM当中需要被改变的部分。<br>通过这成单独抽象的逻辑，让React有了无限的可能，例如ReactNative、ReactVR、ReactXP的实现。</p>
<h5 id="组件-1"><a href="#组件-1" class="headerlink" title="组件"></a>组件</h5><p>组件是可以讲UI切分称为一些独立的、可服用的部分，类似于js当中对function函数的定义。</p>
<h4 id="函数定义与类定义组件-Functional-amp-Class"><a href="#函数定义与类定义组件-Functional-amp-Class" class="headerlink" title="函数定义与类定义组件 Functional &amp; Class"></a>函数定义与类定义组件 Functional &amp; Class</h4><p>新版本的React里提供了两种定义组件的方法</p>
<ul>
<li>通过JS的function来定义组件</li>
<li>通过ES6中的class来定义组件</li>
</ul>
<p>函数定义组件需要定义一个接收props作为参数，返回react元素的方法即可。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'reat'</span></div><div class="line"><span class="keyword">import</span> ReactDOM <span class="keyword">from</span> <span class="string">'react-dom'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> Title = <span class="function">(<span class="params">props</span>) =&gt;</span> &lt;h1&gt;hello,&#123;props.name&#125;&lt;<span class="regexp">/h1&gt;</span></div><div class="line"><span class="regexp">ReactDOM.render(&lt;Title name='react' /</span>&gt;,</div><div class="line">    <span class="built_in">document</span>.getElementById(<span class="string">'app'</span>)</div><div class="line">);</div></pre></td></tr></table></figure>
<p>类定义组件使用ES6中class类的方法来定义</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'reat'</span></div><div class="line"><span class="keyword">import</span> ReactDOM <span class="keyword">from</span> <span class="string">'react-dom'</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Title</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">    render() &#123;</div><div class="line">        <span class="keyword">return</span> &lt;h1&gt;hello,&#123;props.name&#125;&lt;/h1&gt;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">ReactDOM.render(&lt;Title name='react' /&gt;,</div><div class="line">    document.getElementById('app')</div><div class="line">);</div></pre></td></tr></table></figure>
<h4 id="展示与容器组件-Presentational-amp-Container"><a href="#展示与容器组件-Presentational-amp-Container" class="headerlink" title="展示与容器组件 Presentational &amp; Container"></a>展示与容器组件 Presentational &amp; Container</h4><ul>
<li>展示组件主要负责组件内容如何展示，数据来自props或者与数据无关的state，大多情况使用函数声明组件</li>
<li>容器组件主要关注数据如何交互，数据来自state和后端，多数使用class类声明组件</li>
</ul>
<p>☹️ no well ，这类组件负担的功能太多了，他只是一个单一的组件，同时需要初始化state，通过ajax获取服务器数据，渲染列表内容。在实际引用中可能还会有更多的功能依赖，在后续无论要修改样式内容、服务器交互都需要修改同一个组件，逻辑严重的耦合。如果功能在同一个组件维护，也不利于团队间的协作。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'reat'</span></div><div class="line"><span class="keyword">import</span> ReactDOM <span class="keyword">from</span> <span class="string">'react-dom'</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">CommentList</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span></span>&#123;</div><div class="line">    contructor(props) &#123;</div><div class="line">        <span class="keyword">super</span>(props)</div><div class="line">        <span class="keyword">this</span>.state = &#123;</div><div class="line">            comments:[]</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    componentDidMount() &#123;</div><div class="line">        $.ajax(&#123;</div><div class="line">            url:<span class="string">'my-contents.json'</span>,</div><div class="line">            dataType:<span class="string">'json'</span>,</div><div class="line">            sucess:<span class="function"><span class="keyword">function</span>(<span class="params">comments</span>)</span>&#123;</div><div class="line">                <span class="keyword">this</span>.setState(&#123;</div><div class="line">                    coments:coments</div><div class="line">                &#125;)</div><div class="line">            &#125;.bind(<span class="keyword">this</span>)</div><div class="line">        &#125;)</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    renderComment(&#123;body,author&#125;) &#123;</div><div class="line">        <span class="keyword">return</span> &lt;li&gt;&#123;body&#125;-&#123;author&#125;&lt;/li&gt;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    render() &#123;</div><div class="line">        renturn &lt;ul&gt;&#123;<span class="keyword">this</span>.state.comments.map(<span class="keyword">this</span>.renderComment)&#125;&lt;<span class="regexp">/ul&gt;</span></div><div class="line"><span class="regexp">    &#125;</span></div><div class="line"><span class="regexp">    </span></div><div class="line"><span class="regexp">&#125;</span></div></pre></td></tr></table></figure>
<p>😊 good , 区分展示组件和容器组件。回复列表如何展示、如何获取的逻辑就被分离到2个组件中。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'reat'</span></div><div class="line"><span class="keyword">import</span> ReactDOM <span class="keyword">from</span> <span class="string">'react-dom'</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">//展示组件</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">CommentList</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">    contruct(props) &#123;</div><div class="line">        <span class="keyword">super</span>(props)</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    renderComment(&#123;body,author&#125;) &#123;</div><div class="line">        <span class="keyword">return</span> &lt;li&gt;&#123;body&#125;-&#123;author&#125;&lt;/li&gt;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    render() &#123;</div><div class="line">        renturn &lt;ul&gt;&#123;<span class="keyword">this</span>.state.comments.map(<span class="keyword">this</span>.renderComment)&#125;&lt;<span class="regexp">/ul&gt;</span></div><div class="line"><span class="regexp">    &#125;</span></div><div class="line"><span class="regexp">&#125;</span></div><div class="line"><span class="regexp"></span></div><div class="line"><span class="regexp">/</span><span class="regexp">/容器组件</span></div><div class="line"><span class="regexp">class CommentListContainer extends React.Component &#123;</span></div><div class="line"><span class="regexp">    contructor() &#123;</span></div><div class="line"><span class="regexp">        super()</span></div><div class="line"><span class="regexp">        this.state = &#123;</span></div><div class="line"><span class="regexp">            comments:[]</span></div><div class="line"><span class="regexp">        &#125;</span></div><div class="line"><span class="regexp">    &#125;</span></div><div class="line"><span class="regexp">    </span></div><div class="line"><span class="regexp">    componentDidMount() &#123;</span></div><div class="line"><span class="regexp">        $.ajax(&#123;</span></div><div class="line"><span class="regexp">            url:'my-contents.json',</span></div><div class="line"><span class="regexp">            dataType:'json',</span></div><div class="line"><span class="regexp">            sucess:function(comments)&#123;</span></div><div class="line"><span class="regexp">                this.setState(&#123;</span></div><div class="line"><span class="regexp">                    coments:coments</span></div><div class="line"><span class="regexp">                &#125;)</span></div><div class="line"><span class="regexp">            &#125;.bind(this)</span></div><div class="line"><span class="regexp">        &#125;)</span></div><div class="line"><span class="regexp">    &#125;</span></div><div class="line"><span class="regexp">    </span></div><div class="line"><span class="regexp">    render() &#123;</span></div><div class="line"><span class="regexp">        return &lt;CommentList comtents=&#123;this.state.comments&#125; /</span>&gt;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="有状态与无状态组件-Stateful-amp-Stateless"><a href="#有状态与无状态组件-Stateful-amp-Stateless" class="headerlink" title="有状态与无状态组件 Stateful &amp; Stateless"></a>有状态与无状态组件 Stateful &amp; Stateless</h4><ul>
<li>有状态组件可以获取、存储、改变引用本身的数据，伴有state的变化。</li>
<li>无状态组件只接收来自其他组件的传值，只对this.props的调用。</li>
<li>并不是所有的展示组件都是无状态组件，所有的容器组件都是有状态组件。</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'reat'</span></div><div class="line"><span class="keyword">import</span> ReactDOM <span class="keyword">from</span> <span class="string">'react-dom'</span></div><div class="line"></div><div class="line"><span class="comment">//有状态组件</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">StatefullLink</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">    <span class="keyword">constructor</span>(props) &#123;</div><div class="line">        <span class="keyword">super</span>(props)</div><div class="line">        <span class="keyword">this</span>.state = &#123;</div><div class="line">            active:<span class="literal">false</span></div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    handleClick() &#123;</div><div class="line">        <span class="keyword">this</span>.setState(&#123;</div><div class="line">            active: !<span class="keyword">this</span>.state.active</div><div class="line">        &#125;)</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    render() &#123;</div><div class="line">        <span class="keyword">return</span> &lt;a</div><div class="line">            style=&#123;&#123; color: this.state.active ? 'red' : 'black' &#125;&#125;</div><div class="line">            onClick=&#123;this.handleClick.bind(this)&#125;</div><div class="line">        &gt;</div><div class="line">            Stateful Link</div><div class="line">        &lt;/a&gt;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// 无状态组件</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">StatelessLink</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">    contructor(props) &#123;</div><div class="line">        <span class="keyword">super</span>(props)</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    handleClick() &#123;</div><div class="line">        <span class="keyword">this</span>.props.handleClick(<span class="keyword">this</span>.props.router)</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    render() &#123;</div><div class="line">        <span class="keyword">const</span> active = <span class="keyword">this</span>.props.activeRouter === <span class="keyword">this</span>.props.router</div><div class="line">        <span class="keyword">return</span> (</div><div class="line">            &lt;li&gt;</div><div class="line">                &lt;a</div><div class="line">                    style=&#123;&#123; <span class="attr">color</span> : active ? <span class="string">'red'</span> : <span class="string">'black'</span> &#125;&#125;</div><div class="line">                    onClick=&#123;<span class="keyword">this</span>.handleClick.bind(<span class="keyword">this</span>)&#125;</div><div class="line">                &gt;</div><div class="line">                    Stateless Link</div><div class="line">                &lt;<span class="regexp">/a&gt;</span></div><div class="line"><span class="regexp">            &lt;/</span>li&gt;</div><div class="line">        )</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>事实上我们编写的组件大部分都是无状态组件</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'reat'</span></div><div class="line"><span class="keyword">import</span> ReactDOM <span class="keyword">from</span> <span class="string">'react-dom'</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">SimpleButtonES5</span>(<span class="params">props</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> &lt;button&gt;&#123;props.text&#125;&lt;/button&gt;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> SimpleButtonES6 = <span class="function"><span class="params">props</span> =&gt;</span> &lt;button&#123;props.text&#125;&lt;<span class="regexp">/button&gt;</span></div></pre></td></tr></table></figure>
<h4 id="受控与非受控组件-Controlled-amp-Uncontrolled"><a href="#受控与非受控组件-Controlled-amp-Uncontrolled" class="headerlink" title="受控与非受控组件 Controlled &amp; Uncontrolled"></a>受控与非受控组件 Controlled &amp; Uncontrolled</h4><p>一般涉及到表单元素时对组件类型的划分方法</p>
<ul>
<li>一般情况下所有React表单元素都是受控组件，每个受控组件都需要对应的事件处理函数</li>
<li>React通过特殊属性ref来获取非受控组件</li>
</ul>
<p>受控组件的值一般由props或者static传入，用户在元素上交互或者输入内容会引起static的变化，在static改变之后重新渲染组件，我们才能在页面中看到值的变化。假如没有绑定事件处理函数，用户的输入是不会有效果的，这就是受控的含义所在。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ControlledInput</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">    <span class="keyword">constructor</span>() &#123;</div><div class="line">        <span class="keyword">super</span>()</div><div class="line">        <span class="keyword">this</span>.state = &#123;</div><div class="line">            value:<span class="string">'Please type here...'</span></div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    handleChange(event)&#123;</div><div class="line">        <span class="built_in">console</span>.log(<span class="string">'Controlled change:'</span>,event.target.value)</div><div class="line">        <span class="keyword">this</span>.setState(&#123;</div><div class="line">            value:event.target.value</div><div class="line">        &#125;)</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    render() &#123;</div><div class="line">        <span class="keyword">return</span> (</div><div class="line">            &lt;label&gt;</div><div class="line">                Controlled Component:</div><div class="line">                &lt;input type=<span class="string">"text"</span> value=&#123;<span class="keyword">this</span>.state.value&#125; onChange=&#123;(e)=&gt; <span class="keyword">this</span>.handleChange(e)&#125;/&gt;</div><div class="line">            &lt;<span class="regexp">/label&gt;</span></div><div class="line"><span class="regexp">        )</span></div><div class="line"><span class="regexp">    &#125;</span></div><div class="line"><span class="regexp">&#125;</span></div></pre></td></tr></table></figure>
<p>非受控组件类似于传统的DOM表单控件，用户输入不会引起static的改变，我们也不会直接为非受控组件传入值。获取非受控组件的值我们需要使用特殊的ref属性，</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">UncontrolledInput</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">    <span class="keyword">constructor</span>() &#123;</div><div class="line">        <span class="keyword">super</span>()</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    handleChange(event)&#123;</div><div class="line">        <span class="built_in">console</span>.log(<span class="string">'Controlled change:'</span>,event.target.value)</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    render() &#123;</div><div class="line">        <span class="keyword">return</span> (</div><div class="line">            &lt;label&gt;</div><div class="line">                Uncontrolled Component:</div><div class="line">                &lt;input type=<span class="string">"text"</span> defaultValue=<span class="string">'Please type here...'</span> ref=&#123;(input)=&gt; <span class="keyword">this</span>.input = input&#125; onChange=&#123;(e)=&gt; <span class="keyword">this</span>.handleChange(e)&#125;/&gt;</div><div class="line">            &lt;<span class="regexp">/label&gt;</span></div><div class="line"><span class="regexp">        )</span></div><div class="line"><span class="regexp">    &#125;</span></div><div class="line"><span class="regexp">&#125;</span></div></pre></td></tr></table></figure>
<p>通常情况下，react当中所有的表单控件都需要是受控组件，我们需要为每一个受控组件编写事件处理函数。比如说注册，你需要写出所有姓名、电话、邮箱的逻辑。当然也有小技巧可以让同一个事件处理函数引用在多个表单组件中，但生产开发中并没有多大的意义，多是在重构的时候使用。还有一些别的库，需要和表单进行交互，这时候使用非受控组件就会方便一些。</p>
<h4 id="组合与继承-Composition-amp-Inheritance"><a href="#组合与继承-Composition-amp-Inheritance" class="headerlink" title="组合与继承 Composition &amp; Inheritance"></a>组合与继承 Composition &amp; Inheritance</h4><ul>
<li>通过组合和props传值几乎可以满足所有的场景需求，同样也更符合组件化的理念，就好像相互嵌套的DOM元素一样。</li>
<li>继承的写法虽然生效，但是不符合React的理念，在React中，props可以传入任何东西：变量、函数、甚至是组件本身。</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'reat'</span></div><div class="line"><span class="keyword">import</span> ReactDOM <span class="keyword">from</span> <span class="string">'react-dom'</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">InheritedButton</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">    contructor() &#123;</div><div class="line">        <span class="keyword">super</span>()</div><div class="line">        <span class="keyword">this</span>.state = &#123;</div><div class="line">            color: <span class="string">'red'</span></div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    render() &#123;</div><div class="line">        <span class="keyword">return</span> (</div><div class="line">            &lt;button style=&#123;&#123;<span class="attr">backgroundColor</span>: <span class="keyword">this</span>.state.color&#125;&#125; &gt;Inherited Button&lt;<span class="regexp">/button&gt;</span></div><div class="line"><span class="regexp">        )</span></div><div class="line"><span class="regexp">    &#125;</span></div><div class="line"><span class="regexp">&#125;</span></div><div class="line"><span class="regexp"></span></div><div class="line"><span class="regexp">class BlueButton extends InheritedButton &#123;</span></div><div class="line"><span class="regexp">    contructor() &#123;</span></div><div class="line"><span class="regexp">        super()</span></div><div class="line"><span class="regexp">        this.state = &#123;</span></div><div class="line"><span class="regexp">            color:'blue'</span></div><div class="line"><span class="regexp">        &#125;</span></div><div class="line"><span class="regexp">    &#125;</span></div><div class="line"><span class="regexp">&#125;</span></div><div class="line"><span class="regexp"></span></div><div class="line"><span class="regexp">const CompositedButton = props =&gt; &lt;button style=&#123;&#123;backgroundColor:props.color&#125;&#125;Composited Button&lt;/</span>button&gt;</div><div class="line"><span class="keyword">const</span> YellowButton = <span class="function"><span class="params">()</span> =&gt;</span>  &lt;CompositedButton color=<span class="string">"yellow"</span> /&gt;</div><div class="line"></div><div class="line">ReactDOM.render(</div><div class="line">    &lt;div&gt;</div><div class="line">        &lt;BlueButton/&gt;</div><div class="line">        &lt;br/&gt;</div><div class="line">        &lt;YellowButton&gt;</div><div class="line">    &lt;<span class="regexp">/div&gt;,</span></div><div class="line"><span class="regexp">    document.getElementById('app')</span></div><div class="line"><span class="regexp">)</span></div></pre></td></tr></table></figure>
<p>如何想实现一些非洁面类型函数的服用，可以单独写在其他的模块当中，再引入组件进行使用。</p>
<h3 id="组件数据"><a href="#组件数据" class="headerlink" title="组件数据"></a>组件数据</h3><p>三种数据应用类型</p>
<ul>
<li>Props</li>
<li>State</li>
<li>Context</li>
</ul>
<h4 id="Props"><a href="#Props" class="headerlink" title="Props"></a>Props</h4><p>props 就是属性prototype的缩写，在JSX中props就像HTML的attribute一样。在概念上props对于组件，就相当于js当中的参数对应函数一样。组件函数接收props作为参数，然后返回视图的内容。props比起原生的html属性强大许多，可以传入变量、函数、组件 …</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//Function</span></div><div class="line">Component(props) = View</div><div class="line"></div><div class="line"><span class="comment">//JSX</span></div><div class="line"><span class="keyword">const</span> SimpleButton = <span class="function"><span class="params">props</span> =&gt;</span> &lt;button className=&#123;props.color&#125;&gt;Submit&lt;<span class="regexp">/button&gt;</span></div><div class="line"><span class="regexp">ReactDOM.render(&lt;SimpleButton color="blue"/</span>&gt;,<span class="built_in">document</span>.getElementById(<span class="string">'app'</span>))</div><div class="line"></div><div class="line"><span class="comment">//HTML</span></div><div class="line">&lt;button <span class="class"><span class="keyword">class</span></span>=<span class="string">"blue"</span>&gt;Submit&lt;<span class="regexp">/button&gt;</span></div></pre></td></tr></table></figure>
<p>Props的值自上向下传递，从父组件传入到子组件当中，并且props是自读的，不能在组件中修改props的内容。 就是说组件只能通过传入的props值渲染界面，内部不能对props值进行修改。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> Children = <span class="function"><span class="params">props</span> =&gt;</span> &lt;p&gt;&#123;props.name&#125;&lt;<span class="regexp">/p&gt;</span></div><div class="line"><span class="regexp">const Father = &lt;Children name="Bob"/</span>&gt;</div></pre></td></tr></table></figure>
<p>Props有类型检查和默认值</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></div><div class="line"><span class="keyword">import</span> ReactDOM <span class="keyword">from</span> <span class="string">'react-dom'</span></div><div class="line"><span class="keyword">import</span> PropTypes <span class="keyword">from</span> <span class="string">'prop-types'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> Title = <span class="function"><span class="params">props</span> =&gt;</span> &lt;h1&gt;&#123;props.title&#125;&lt;<span class="regexp">/h1&gt;</span></div><div class="line"><span class="regexp"></span></div><div class="line"><span class="regexp">Title.defaultProps = &#123;</span></div><div class="line"><span class="regexp">    title: 'Hello world!'</span></div><div class="line"><span class="regexp">&#125;</span></div><div class="line"><span class="regexp"></span></div><div class="line"><span class="regexp">Title.propTypes = &#123;</span></div><div class="line"><span class="regexp">    title: PropTypes.string.isRequired</span></div><div class="line"><span class="regexp">&#125;</span></div><div class="line"><span class="regexp"></span></div><div class="line"><span class="regexp">ReactDOM.render(&lt;Title/</span>&gt;,<span class="built_in">document</span>.getElementById(<span class="string">'app'</span>))</div></pre></td></tr></table></figure>
<h4 id="State"><a href="#State" class="headerlink" title="State"></a>State</h4><p>state翻译过来可以为状态，一个组件可以有自身的状态，也可以包含整个react应用的状态。例如：通过API从服务器获取数据，然后渲染到页面，就是我们用到state的时候。</p>
<ul>
<li>初始化</li>
<li>setState方法</li>
<li>向下传递数据</li>
<li>State management 状态管理</li>
<li>服务器数据交互</li>
<li>用户输入交互</li>
<li>多个组件共用的State存放在其公有的父组件里</li>
</ul>
<p>简单的计数器例子 ，通过class类定义组件来声明一个有状态组件，然后在构造方法中初始化状态的state并为它赋默认值。之后就能通过this.state来访问它，我们在添加一个负责处理state变化的函数addOne，通过setState的方法来改变state值。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'reat'</span></div><div class="line"><span class="keyword">import</span> ReactDOM <span class="keyword">from</span> <span class="string">'react-dom'</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Conter</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">    <span class="keyword">constructor</span>(props) &#123;</div><div class="line">        <span class="keyword">super</span>(props)</div><div class="line">        <span class="keyword">this</span>.state = &#123;</div><div class="line">            counter:<span class="number">0</span></div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    addOne() &#123;</div><div class="line">        <span class="keyword">this</span>.setState(&#123;</div><div class="line">            counter:<span class="keyword">this</span>.state.counter +<span class="number">1</span></div><div class="line">        &#125;)</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    render() &#123;</div><div class="line">        <span class="keyword">return</span>(</div><div class="line">            &lt;div&gt;</div><div class="line">                &lt;p&gt;&#123;<span class="keyword">this</span>.state.counter&#125;&lt;<span class="regexp">/p&gt;</span></div><div class="line"><span class="regexp">                &lt;button onClick=&#123;()=&gt;this.addOne()&#125;&gt;Increment&lt;/</span>button&gt;</div><div class="line">            &lt;<span class="regexp">/div&gt;</span></div><div class="line"><span class="regexp">        )</span></div><div class="line"><span class="regexp">    &#125;</span></div><div class="line"><span class="regexp">&#125;</span></div><div class="line"><span class="regexp"></span></div><div class="line"><span class="regexp">ReactDOM.render(&lt;Counter /</span>&gt;,<span class="built_in">document</span>.getElementById(<span class="string">'app'</span>))</div></pre></td></tr></table></figure>
<p>复杂点的点赞例子 。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'reat'</span></div><div class="line"><span class="keyword">import</span> ReactDOM <span class="keyword">from</span> <span class="string">'react-dom'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> Title = <span class="function"><span class="params">props</span> =&gt;</span> &lt;h1&gt;&#123;props.title&#125;&lt;<span class="regexp">/h1&gt;</span></div><div class="line"><span class="regexp">const UserInfo = props =&gt; &lt;p&gt;&#123;props.firstName + ' ' + props.lastName&#125;&lt;/</span>p&gt;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">LikeButton</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">    <span class="keyword">constructor</span>(props) &#123;</div><div class="line">        <span class="keyword">super</span>(props)</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    handleClick() &#123;</div><div class="line">        <span class="keyword">this</span>.props.handleClick()</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    render() &#123;</div><div class="line">        <span class="keyword">return</span> &lt;button onClick&#123;()=&gt;this.handleClick()&#125;&gt;&#123;this.props.mark&#125;&lt;/button&gt;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">App</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">    <span class="keyword">constructor</span>(props)&#123;</div><div class="line">        <span class="keyword">super</span>(props)</div><div class="line">        <span class="keyword">this</span>.state = &#123;</div><div class="line">            mark:<span class="string">'☆'</span></div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    handleButtonClick()&#123;</div><div class="line">        <span class="keyword">const</span> mark = (<span class="keyword">this</span>.state.mark === <span class="string">'☆'</span>) ? <span class="string">'★'</span> : <span class="string">'☆'</span>;</div><div class="line">        <span class="keyword">this</span>.setState(&#123;</div><div class="line">            mark:mark</div><div class="line">        &#125;)</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    render() &#123;</div><div class="line">        <span class="keyword">return</span> (</div><div class="line">            &lt;div&gt;</div><div class="line">                &lt;Title title=<span class="string">"Hello , jikexueyuan"</span>/&gt;</div><div class="line">                &lt;UserInfo firseName=<span class="string">"Jax"</span> lastName=<span class="string">"Chu"</span> /&gt;</div><div class="line">                &lt;LikeButton mark=&#123;<span class="keyword">this</span>.state.mark&#125; handleClick&#123;()=&gt;<span class="keyword">this</span>.handleButtonClick()&#125;</div><div class="line">            &lt;<span class="regexp">/div&gt;</span></div><div class="line"><span class="regexp">        )</span></div><div class="line"><span class="regexp">    &#125;</span></div><div class="line"><span class="regexp">&#125;</span></div><div class="line"><span class="regexp"></span></div><div class="line"><span class="regexp">const Root = props =&gt; &lt;div className="container"&gt;&#123;props.children&#125;&lt;/</span>div&gt;</div><div class="line"></div><div class="line">ReactDOM.render(</div><div class="line">    &lt;Root&gt;</div><div class="line">        &lt;App/&gt;</div><div class="line">    &lt;<span class="regexp">/Root&gt;</span></div><div class="line"><span class="regexp">    ,document.getElementById('app'))</span></div></pre></td></tr></table></figure>
<p>假如State分散到应用的各个部分，有的复杂后端数据的交互，有的处理用户输入，有的负责页面变化的逻辑，后期维护是相当困难的。因此在开发React应用中，我们应尽量把State统一管理，通过props把state的数据传递到组件当中。货币汇率转换器 </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'reat'</span></div><div class="line"><span class="keyword">import</span> ReactDOM <span class="keyword">from</span> <span class="string">'react-dom'</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">CurrencyConvertor</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Componnet</span> </span>&#123;</div><div class="line">    <span class="keyword">constructor</span>()&#123;</div><div class="line">        <span class="keyword">super</span>()</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">this</span>.state = &#123;</div><div class="line">        money : <span class="number">100</span></div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    handleInputChange(event) &#123;</div><div class="line">        <span class="keyword">this</span>.setState(&#123;</div><div class="line">            money:event.target.value</div><div class="line">        &#125;)</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    render() &#123;</div><div class="line">        <span class="keyword">return</span> (</div><div class="line">            &lt;div&gt;</div><div class="line">                &lt;h2&gt;货币兑换&lt;<span class="regexp">/h2&gt;</span></div><div class="line"><span class="regexp">                &lt;YuanInput money=&#123;this.state.money&#125; handleChange=&#123;(e)=&gt; this.handleInputChange(e)&#125; /</span>&gt;</div><div class="line">                &lt;MoneyCovertor type=<span class="string">'美元'</span> unit=<span class="string">'dollar'</span> money=&#123;<span class="keyword">this</span>.state.money&#125; rate=&#123;<span class="number">0.1453</span>&#125; /&gt;</div><div class="line">                &lt;MoneyCovertor type=<span class="string">'日元'</span> unit=<span class="string">'yen'</span> money=&#123;<span class="keyword">this</span>.state.money&#125; rate=&#123;<span class="number">16.1814</span>&#125; /&gt;</div><div class="line">        )</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">YuanInput</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">    <span class="keyword">constructor</span>(props)&#123;</div><div class="line">        <span class="keyword">super</span>(props)</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    handleChange(event)&#123;</div><div class="line">        <span class="keyword">this</span>.props.handleChange(event)</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    render() &#123;</div><div class="line">        <span class="keyword">return</span> (</div><div class="line">            &lt;p&gt;</div><div class="line">                &lt;lable&gt;</div><div class="line">                人民币</div><div class="line">                &lt;input name=<span class="string">'yuan'</span> onChange=&#123;(e)=&gt;<span class="keyword">this</span>.handleChange(e)&#125; value=&#123;<span class="keyword">this</span>.props.money&#125;</div><div class="line">                &lt;<span class="regexp">/lable&gt;</span></div><div class="line"><span class="regexp">            &lt;/</span>p&gt;</div><div class="line">        )</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MoneyCovertor</span> </span>= props =&gt; (</div><div class="line">    &lt;p&gt;</div><div class="line">        &lt;lable&gt;</div><div class="line">            &#123;props.type&#125;</div><div class="line">            &lt;input name=&#123;props.unit&#125; value=&#123;(props.money * props.rate).toFixed(<span class="number">2</span>)&#125; disabled /&gt;</div><div class="line">        &lt;<span class="regexp">/lable&gt;</span></div><div class="line"><span class="regexp">    &lt;/</span>p&gt;</div><div class="line">)</div><div class="line"></div><div class="line">ReactDOM.render(&lt;CurrencyConvertor /&gt; ,document.getElementById('app'))</div></pre></td></tr></table></figure>
<h4 id="context"><a href="#context" class="headerlink" title="context"></a>context</h4><p>集中管理state会引发另一个问题，state的数据都是自上而下传递的，假如我们在最外一层进行组件管理，而我们使用的子组件确在N层之下，那么我们就需要在每一层的组件都传递props下去。所以React提供 Context 带有实验性质，用于跨层级传递数据。必须进行类型检查。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'reat'</span></div><div class="line"><span class="keyword">import</span> ReactDOM <span class="keyword">from</span> <span class="string">'react-dom'</span></div><div class="line"><span class="keyword">import</span> PropTypes <span class="keyword">from</span> <span class="string">'prop-types'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> UserInfo = <span class="function">(<span class="params">props,content</span>) =&gt;</span> (</div><div class="line">    &lt;div className=<span class="string">"UserInfo-name"</span>&gt;&#123;context.lastName +<span class="string">','</span>+ props.firstName&#125;&lt;<span class="regexp">/div&gt;</span></div><div class="line"><span class="regexp">)</span></div><div class="line"><span class="regexp">UserInfo.contextTypes = &#123;</span></div><div class="line"><span class="regexp">    lastName:PropTypes.string</span></div><div class="line"><span class="regexp">&#125;</span></div><div class="line"><span class="regexp"></span></div><div class="line"><span class="regexp">const Column = props =&gt; &lt;div className='column'&gt;&lt;UserInfo firseName=&#123;props.firstName&#125; /</span>&gt;&lt;div&gt;</div><div class="line">const Row    = props =&gt; &lt;div className='row'&gt;&lt;Columen firseName=&#123;props.firstName&#125; /&gt;&lt;/div&gt;</div><div class="line">const Container = props =&gt; &lt;div className='container'&gt;&lt;Row firstName=&#123;props.firstName&#125; /&gt;&lt;/div&gt;</div><div class="line"></div><div class="line">calss App extends React.component &#123;</div><div class="line">    constructor() &#123;</div><div class="line">        super()</div><div class="line">        this.state = &#123;</div><div class="line">            fisetName: 'Chu',</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    getChildContent() &#123;</div><div class="line">        return &#123;</div><div class="line">            lastName: 'Jax'</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    render() &#123;</div><div class="line">        return (</div><div class="line">            &lt;div className="app"&gt;</div><div class="line">                &lt;Container first=&#123;this.state.firstName&#125; /&gt;</div><div class="line">            &lt;/div&gt;</div><div class="line">        )</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">App.childContextTypes = &#123;</div><div class="line">    lastName: PropTypes.string</div><div class="line">&#125;</div><div class="line"></div><div class="line">ReactDOM.render(&lt;App/&gt;,document.getElementById('root'))</div></pre></td></tr></table></figure>
<h3 id="组件生命周期"><a href="#组件生命周期" class="headerlink" title="组件生命周期"></a>组件生命周期</h3><h4 id="React-是如何渲染组件的？"><a href="#React-是如何渲染组件的？" class="headerlink" title="React 是如何渲染组件的？"></a>React 是如何渲染组件的？</h4><p>一般来讲，我们都会先定义一个组件，我们想要在页面当中看到这个组件渲染的结果的话，需要用JSX的形式把组件传入到ReactDOM.render方法中作为第一个参数。JSX通过React转化其实是一个react.createElement的方法。render方法获取到react元素中会将它实例化，更具React实例的元素创建出真实DOM。再更具第二个参数的指向，讲创建好的元素插入到目标DOM容器当中。</p>
<p>再新版本的React当中，React的底层被重写，换上新的引擎，React Fiber。它将React更新应用界面分成了2个主要的部分，调度过程与执行过程。</p>
<p>在调度过程中，有四个生命周期会被触发：</p>
<ul>
<li>componentWillMount</li>
<li>conponentWillReceiveProps</li>
<li>shouldComponentUpdate</li>
<li>componentWillUpdate</li>
</ul>
<p>在执行过程中，有三个生命周期会被触发：</p>
<ul>
<li>componentDidMount</li>
<li>componentDidUpdate</li>
<li>componentWillUnmount</li>
</ul>
<p>React为了方便我们控制自己的引用提供了许多预知的生命周期方法，就想以上的生命周期方法，会在组件挂载流程、更新流程、卸载流程中触发。React初次渲染时，属于挂载流程，后续更新时的都是更新流程，最后我们还可以通过ReactDOM.unmountComponentAtNode将组件卸载，其中进行的就是卸载流程。</p>
<p>举个栗子 。这里我们定义2个组件，父组件会传递state到子组件当中，顺便state的变化和props的传递流程我们也可以从这个 中看到。子组件每一个生命周期函数中，都在控制台输出相关的信息。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"root"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">"render"</span>&gt;</span>渲染<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'reat'</span></div><div class="line"><span class="keyword">import</span> ReactDOM <span class="keyword">from</span> <span class="string">'react-dom'</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Number</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">  <span class="keyword">constructor</span>(props) &#123;</div><div class="line">    <span class="keyword">super</span>(props)</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'%cconstructor'</span> + <span class="string">'%c 子组件已构造'</span>, <span class="string">'font-weight:bold'</span>, <span class="string">'color: blue'</span>)</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  componentWillMount() &#123;</div><div class="line">    <span class="built_in">console</span>.group(<span class="string">"%c React 挂载"</span>, <span class="string">'color: #00d8ff'</span>)</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'%ccomponentWillMount'</span> + <span class="string">'%c 组件即将挂载'</span>, <span class="string">'font-weight:bold'</span>, <span class="string">''</span>)</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  componentDidMount() &#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'%ccomponentDidMount'</span> + <span class="string">'%c 组件已挂载'</span>, <span class="string">'font-weight:bold'</span>, <span class="string">''</span>)</div><div class="line">    <span class="built_in">console</span>.groupEnd();</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'\n'</span>)</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  componentWillReceiveProps(newProps) &#123;</div><div class="line">    <span class="built_in">console</span>.group(<span class="string">"%c React 更新"</span>, <span class="string">'color: green'</span>)</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'%ccomponentWillReceiveProps'</span> + <span class="string">'%c 组件即将接收props'</span>, <span class="string">'font-weight:bold'</span>, <span class="string">''</span>)</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'newProps'</span>, newProps.counter)</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'this.props'</span>, <span class="keyword">this</span>.props.counter)</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  shouldComponentUpdate(newProps, newState) &#123;</div><div class="line">    <span class="keyword">const</span> result = <span class="literal">true</span></div><div class="line">    <span class="built_in">console</span>.info(<span class="string">'%cshouldComponentUpdate'</span> + <span class="string">'%c 返回判断是否要更新组件'</span> + <span class="string">`%c <span class="subst">$&#123;result&#125;</span>`</span>, <span class="string">'font-weight:bold'</span>, <span class="string">'color: #ff3c41'</span>, <span class="string">'font-weight:bold;color: #236fd4'</span>)</div><div class="line">    <span class="keyword">if</span> (!result) <span class="built_in">console</span>.groupEnd()</div><div class="line">    <span class="keyword">return</span> result;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  componentWillUpdate(nextProps, nextState) &#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'%ccomponentWillUpdate'</span> + <span class="string">'%c 组件即将更新'</span>, <span class="string">'font-weight:bold'</span>, <span class="string">''</span>)</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'nextProps'</span>, nextProps.counter)</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'this.props'</span>, <span class="keyword">this</span>.props.counter)</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  componentDidUpdate(prevProps, prevState) &#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'%ccomponentDidUpdate'</span> + <span class="string">'%c 组件已更新'</span>, <span class="string">'font-weight:bold'</span>, <span class="string">''</span>)</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'prevProps'</span>, prevProps.counter)</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'this.props'</span>, <span class="keyword">this</span>.props.counter)</div><div class="line">    <span class="built_in">console</span>.groupEnd();</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'\n'</span>)</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  componentWillUnmount() &#123;</div><div class="line">    <span class="built_in">console</span>.group(<span class="string">"%c React 卸载"</span>, <span class="string">'color: brown'</span>)</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'%ccomponentWillUnmount'</span> + <span class="string">'%c 组件即将卸载'</span>, <span class="string">'font-weight:bold'</span>, <span class="string">'color: gray'</span>)</div><div class="line">    <span class="built_in">console</span>.groupEnd();</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'\n'</span>)</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  render() &#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'%crender'</span> + <span class="string">'%c 组件渲染中...'</span>, <span class="string">'font-weight:bold'</span>, <span class="string">''</span>)</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'this.props'</span>, <span class="keyword">this</span>.props.counter)</div><div class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123; this.props.counter &#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Counter</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">  <span class="keyword">constructor</span>(props) &#123;</div><div class="line">    <span class="keyword">super</span>(props)</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'%cconstructor'</span> + <span class="string">'%c 父组件已构造'</span>, <span class="string">'font-weight:bold'</span>, <span class="string">'color: #ae63e4'</span>)</div><div class="line"></div><div class="line">  &#125;</div><div class="line"></div><div class="line">  componentWillMount() &#123;</div><div class="line">    <span class="keyword">this</span>.state = &#123;</div><div class="line">      counter: <span class="number">0</span></div><div class="line">    &#125;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'this.state'</span>, <span class="keyword">this</span>.state.counter)</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  shouldComponentUpdate(newProps, newState) &#123;</div><div class="line">    <span class="keyword">const</span> result = <span class="literal">true</span></div><div class="line">    <span class="built_in">console</span>.info(<span class="string">'%cshouldComponentUpdate'</span> + <span class="string">'%c 返回判断是否要更新父组件'</span> + <span class="string">`%c <span class="subst">$&#123;result&#125;</span>`</span>, <span class="string">'font-weight:bold'</span>, <span class="string">'color: #ff3c41'</span>, <span class="string">'font-weight:bold;color: #236fd4'</span>)</div><div class="line">    <span class="keyword">return</span> result;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  addOne() &#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'%caddOne()'</span> + <span class="string">'%c 事件处理函数触发'</span>, <span class="string">'font-weight:bold'</span>, <span class="string">''</span>)</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'prevState'</span>, <span class="keyword">this</span>.state.counter)</div><div class="line">    <span class="keyword">this</span>.setState(<span class="function">(<span class="params">prevState</span>) =&gt;</span> (&#123;</div><div class="line">      counter: prevState.counter + <span class="number">1</span></div><div class="line">    &#125;))</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  unMount() &#123;</div><div class="line">    ReactDOM.unmountComponentAtNode(<span class="built_in">document</span>.getElementById(<span class="string">'root'</span>));</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  update() &#123;</div><div class="line">    <span class="keyword">this</span>.forceUpdate()</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  render() &#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'%crender'</span> + <span class="string">'%c 父组件渲染中...'</span>, <span class="string">'font-weight:bold'</span>, <span class="string">''</span>)</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'nextState'</span>, <span class="keyword">this</span>.state.counter)</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'\n'</span>)</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      &lt;div&gt;</div><div class="line">        &lt;<span class="built_in">Number</span> counter=&#123;<span class="keyword">this</span>.state.counter&#125; /&gt;</div><div class="line">        &lt;button</div><div class="line">          onClick=&#123;() =&gt; <span class="keyword">this</span>.addOne()&#125;&gt;</div><div class="line">          增加</div><div class="line">        &lt;<span class="regexp">/button&gt;</span></div><div class="line"><span class="regexp">        &lt;button</span></div><div class="line"><span class="regexp">          onClick=&#123;() =&gt; this.update()&#125;&gt;</span></div><div class="line"><span class="regexp">          强制更新</span></div><div class="line"><span class="regexp">        &lt;/</span>button&gt;</div><div class="line">        &lt;button</div><div class="line">          onClick=&#123;() =&gt; <span class="keyword">this</span>.unMount()&#125;&gt;</div><div class="line">          卸载</div><div class="line">        &lt;<span class="regexp">/button&gt;</span></div><div class="line"><span class="regexp">      &lt;/</span>div&gt;</div><div class="line">    )</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> render = <span class="function"><span class="params">()</span> =&gt;</span> ReactDOM.render(</div><div class="line">  &lt;Counter /&gt;,</div><div class="line">  <span class="built_in">document</span>.getElementById(<span class="string">'root'</span>)</div><div class="line">)</div><div class="line"><span class="comment">//render()</span></div><div class="line"></div><div class="line"><span class="built_in">document</span>.getElementById(<span class="string">'render'</span>).addEventListener(<span class="string">'click'</span>, render)</div></pre></td></tr></table></figure>
<p>首先是组件初次渲染的挂载流程，我们通过一个按钮，绑定一个渲染函数来主动触发组件的渲染。初次挂载组件时，我们构建的组件类会被挂载声明，在渲染之前会触发<code>componentWillMount</code>，在渲染之后会触发<code>componentDidMount</code>这2个生命周期函数。</p>
<p><code>componentWillMount</code>会在渲染之前被触发，并且只会被组件被渲染之前触发一次。如果使用ES6的class声明组件的话，时机和作用几乎和<code>constructor</code>相同。在<code>componentWillMount</code>对state的定义或者改变，是不会触发新的渲染的。</p>
<p><code>componentDidMount</code>会在渲染完成之后被触发，同样自会触发一次。在这个方法中，已经可以访问到渲染到页面的DOM元素了，所以官方推荐在这个方法中可以进行一些类似于AJAX请求的操作，是我们最经常使用的生命周期函数。</p>
<p>父组件会向子组件更新props的数值，这时候会触发<code>componentWillReceiveProps</code>。组件在运行这一流程，props还没有被改变。然后就会就会触发<code>shouldComponentUpdate</code>，默认返回true，如果返回false的话，更新流程会被跳过，渲染也不会继续被触发。假如要提升应用的性能，可以在这个函数中进行自定义的判断来跳过不需要被更新的组件。组件在初次渲染时，和forceUpdate时，是不会触发这个函数的。</p>
<p><code>componentWillUpdate</code>和<code>componentDidUpdate</code>会在更新渲染的前后触发。在<code>componentWillUpdate</code>里无法调用this.setState，可以理解为更新流程到这一步想要更改state已经晚了，如果有需要可以在<code>componentWillReceiveProps</code>中更新state，React会把改变合并到同一个更新流程里面执行。而<code>componentDidUpdate</code>是另一个适合我们发起AJAX请求的地方，在这里我们还可以比较前后的props变化，再决定是否发起网络请求。比较实用的场景就是保存用户的输入到服务器，用户可能会来来回回修改内容，如果我们判断修改前后数据最终没有被改变，那就没有必要发起不必要的网络请求了。</p>
<p>通过<code>ReactDOM.unmountComponentAtNode</code>来卸载已经挂载了的React组件。在卸载流程的<code>componentWillUnmount</code>是我们解绑事件最合适的位置。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line">&gt;&gt; constructor 父组件以及构造</div><div class="line">&gt;&gt; this.state 0</div><div class="line">&gt;&gt; render 父组件渲染中...</div><div class="line">&gt;&gt; nextState 0</div><div class="line"></div><div class="line">&gt;&gt;子组件已构造</div><div class="line">&gt;&gt;componentWillMount 组件即将挂载</div><div class="line">&gt;&gt;render 组件渲染中</div><div class="line">&gt;&gt;this.props 0</div><div class="line">&gt;&gt;componentDidMount 组件已挂载 </div><div class="line"></div><div class="line">&gt;&gt;addOne() 事件处理函数触发</div><div class="line">&gt;&gt;prevState 0</div><div class="line">&gt;&gt;shouldComponentUpdate 返回判断是否要更新父组件 <span class="literal">true</span></div><div class="line">&gt;&gt;render 父组件渲染中...</div><div class="line">&gt;&gt;nextState 1</div><div class="line"></div><div class="line">&gt;&gt;componentWillReceiveProps 组件即将接受Props</div><div class="line">&gt;&gt;nextProps 1</div><div class="line">&gt;&gt;this.props 0</div><div class="line">&gt;&gt;shouldComponentUpdate 返回判断是否要更新组件 <span class="literal">true</span></div><div class="line">&gt;&gt;&gt;&gt;componentWillUpdate 组件即将更新</div><div class="line">&gt;&gt;nextProps 1</div><div class="line">&gt;&gt;this.props 0</div><div class="line">&gt;&gt;render 组件渲染中</div><div class="line">&gt;&gt;this.props 1</div><div class="line">&gt;&gt;componentDidUpdate 组件已更新</div><div class="line">&gt;&gt;preProps 0</div><div class="line">&gt;&gt;this.props 1</div><div class="line"></div><div class="line">&gt;&gt; componentWillUnmount 组件即将卸载</div></pre></td></tr></table></figure>
<p><a href="https://codepen.io/discountry/pen/wJNpop" target="_blank" rel="external">React异步获取文章小 </a></p>
<p>通过const的关键字声明，使用arrowFunction 定义一个简单的 RedditList 展示组件。一般组件包含多层嵌套的JSX的时候，都会加上一个小括号，因为浏览器在某些情况下可能会对换行的代码加上分号。 JSX当中时可以使用js表达式的，一般在渲染列表中都会拿到一个数组数据，通过map的方法渲染出列表中的每一项。JSX在渲染列表项的时候，每一项都必须带有key属性，作为识别列表中某一项的标识，React在渲染列表的时候会通过key来判断每一个的内容。</p>
<p>使用类定义的方法来定义一个 RedditFetch 容器组件。首先把posts初始化为数组，定义一个从服务器获取数据的方法fetchFromApi，在请求成功之后重新设置state，获取到帖子的数据。在componentDidMount中调取fetchFromApi，在componentWillUnmount中解除向服务器发起的请求。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> RedditList = <span class="function"><span class="params">props</span> =&gt;</span> (</div><div class="line">    &lt;div&gt;</div><div class="line">        &lt;h1&gt;&#123;<span class="string">`/r/<span class="subst">$&#123;props.subreddit&#125;</span>`</span>&#125;&lt;<span class="regexp">/h1&gt;</span></div><div class="line"><span class="regexp">        &lt;ul&gt;</span></div><div class="line"><span class="regexp">            &#123;props.posts.map(post =&gt;</span></div><div class="line"><span class="regexp">                &lt;li key=&#123;post.id&#125;&gt;</span></div><div class="line"><span class="regexp">                    &lt;a href=&#123;post.url&#125;&gt;&#123;post.title&#125;&lt;/</span>a&gt;  </div><div class="line">                &lt;<span class="regexp">/li&gt;</span></div><div class="line"><span class="regexp">            )&#125;</span></div><div class="line"><span class="regexp">        &lt;/u</span>l&gt;</div><div class="line">    &lt;<span class="regexp">/div&gt;</span></div><div class="line"><span class="regexp">)</span></div><div class="line"><span class="regexp"></span></div><div class="line"><span class="regexp">class RedditFetch extends React.Component &#123;</span></div><div class="line"><span class="regexp">    constructor(props) &#123;</span></div><div class="line"><span class="regexp">        super(props)</span></div><div class="line"><span class="regexp">            this.state = &#123;</span></div><div class="line"><span class="regexp">                posts: []</span></div><div class="line"><span class="regexp">        &#125;</span></div><div class="line"><span class="regexp">    &#125;</span></div><div class="line"><span class="regexp">  </span></div><div class="line"><span class="regexp">    fetchFromApi() &#123;</span></div><div class="line"><span class="regexp">        this.serverRequest = axios.get(`https:/</span><span class="regexp">/www.reddit.com/</span>r/$&#123;<span class="keyword">this</span>.props.subreddit&#125;.json<span class="string">`)</span></div><div class="line"><span class="string">            .then(res =&gt; &#123;</span></div><div class="line"><span class="string">                const posts = res.data.data.children.map(obj =&gt; obj.data)</span></div><div class="line"><span class="string">                this.setState(&#123;</span></div><div class="line"><span class="string">                    posts</span></div><div class="line"><span class="string">            &#125;)</span></div><div class="line"><span class="string">        &#125;)</span></div><div class="line"><span class="string">    &#125;</span></div><div class="line"><span class="string">  </span></div><div class="line"><span class="string">    componentDidMount() &#123;</span></div><div class="line"><span class="string">        this.fetchFromApi()</span></div><div class="line"><span class="string">    &#125;</span></div><div class="line"><span class="string">  </span></div><div class="line"><span class="string">    componentWillUnmount() &#123;</span></div><div class="line"><span class="string">        this.serverRequest.abort()</span></div><div class="line"><span class="string">    &#125;</span></div><div class="line"><span class="string">  </span></div><div class="line"><span class="string">    render() &#123;</span></div><div class="line"><span class="string">        return &lt;RedditList subreddit=&#123;this.props.subreddit&#125; posts=&#123;this.state.posts&#125; /&gt;</span></div><div class="line"><span class="string">    &#125;</span></div><div class="line"><span class="string">&#125;</span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string">ReactDOM.render(&lt;RedditFetch subreddit="reactjs" /&gt;,document.getElementById('root'))</span></div></pre></td></tr></table></figure>
<p>小结</p>
<ul>
<li>React组件渲染包括三个流程：挂载流程、更新流程、卸载流程。</li>
<li>各个生命周期函数会在特定的时候触发并适用于不同的使用场景。</li>
<li>通过使用生命周期函数我们可以对应用进行更精准的控制。</li>
<li>如果你需要发起网络请求，将其安排在适合的生命函数周期中。</li>
</ul>
<h3 id="表单及事件处理"><a href="#表单及事件处理" class="headerlink" title="表单及事件处理"></a>表单及事件处理</h3><p>JSX中使用的和HTML同名的元素，并不等同于原生的HTML标签，只是React抽象出来的一种标签的写法。举个例子 </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">&lt;textarea value=&#123;<span class="keyword">this</span>.state.value&#125; onChange=&#123;<span class="keyword">this</span>.handleChange&#125;/&gt;</div><div class="line"></div><div class="line">&lt;select value=&#123;<span class="keyword">this</span>.state.value&#125; onChange=&#123;<span class="keyword">this</span>.handleChange&#125;&gt;</div><div class="line">    &lt;option value=<span class="string">"grapefruit"</span>&gt;Grapefruit&lt;<span class="regexp">/option&gt;</span></div><div class="line"><span class="regexp">    &lt;option value="lime"&gt;Lime&lt;/</span>option&gt;</div><div class="line">    &lt;option value=<span class="string">"coconut"</span> &gt;Coconut&lt;<span class="regexp">/option&gt;</span></div><div class="line"><span class="regexp">&lt;/</span>select&gt;</div></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">textarea</span> &gt;</span></div><div class="line">    Hello , React !</div><div class="line"><span class="tag">&lt;/<span class="name">textarea</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">select</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">"grapefruit"</span>&gt;</span>Grapefruit<span class="tag">&lt;/<span class="name">option</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">"lime"</span>&gt;</span>Lime<span class="tag">&lt;/<span class="name">option</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">"coconut"</span> <span class="attr">select</span> &gt;</span>Coconut<span class="tag">&lt;/<span class="name">option</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></div></pre></td></tr></table></figure>
<p>事件也是React内部封装的，由小驼峰命名，并不等同于HTML DOM的原生事件，可以通过以下地址<a href="https://facebook.github.io/react/docs/events.html" target="_blank" rel="external">link</a>查看。</p>
<h2 id="Redux-数据处理"><a href="#Redux-数据处理" class="headerlink" title="Redux 数据处理"></a>Redux 数据处理</h2><h3 id="Redux简介"><a href="#Redux简介" class="headerlink" title="Redux简介"></a>Redux简介</h3><p>React技术栈的主要适用情景是Web应用，Web应用涉及非常多的用户交互和状态数据改变。我们应该尽量控制应用中有状态组件的个数，应用数据应该尽量集中统一管理，否则后期维护成本较高。之前介绍有状态组件与无状态组件，React也推荐我们控制有状态组件的个数，在我们开发过程中编写的90%都应该是无状态组件。React本身提供给我们控制引用数据的方式只有props、state 及带有实验性质的context。React本身并没有提供应用状态管理的解决方案，在小的应用中可能感受不到状态管理是一个问题，但随着应用复杂度的增加，这个问题就会暴露得越来越明显，这个时候就可以考虑使用Redux。</p>
<p>既然React推荐我们尽量少的编写有状态组件，为何不干脆把一个应用所有的状态数据集中到一个地方管理呢？这便是Redux的理念。Redux把应用的数据统一储存在一个对象当中，把应用的所有的数据交互及引用状态的改变统一用固定形式的action动作对象来描述，并由reducer的方法来判断不同的动作如何改变引用状态，最后通过store对象来执行action动作获取state应用状态，并触发改变应用状态的事件。</p>
<p>实际上Redux提供的是一种应用状态的解决思路，我们可以用基本的原生JS方法来实现Redux的全部功能。并且我们就算引入Redux编写的大部分的是原生的JS函数和对象。</p>
<p>举个例子 ，原生JS模拟实现Redux。<br>首先定义一个counter的函数，接受state和action参数。state就是状态数据，而action是一个带有type的js对象。通过对type的判断，返回新的state，这样的函数在redux中被称为redcer。通过counter返回的默认值作为容器的初始state值，为组件添加increment、decrement方法，事实上都是调用dispatch方法。在dispatch方法中调用counter函数，将先用的应用状态和action方法传递</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React, &#123; Component &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"></div><div class="line"><span class="comment">// Reducer</span></div><div class="line"><span class="keyword">const</span> counter = <span class="function">(<span class="params">state = &#123; value: <span class="number">0</span> &#125;, action</span>) =&gt;</span> &#123;</div><div class="line">    <span class="keyword">switch</span> (action.type) &#123;</div><div class="line">        <span class="keyword">case</span> <span class="string">'INCREMENT'</span>:</div><div class="line">            <span class="keyword">return</span> &#123; <span class="attr">value</span>: state.value + <span class="number">1</span> &#125;;</div><div class="line">        <span class="keyword">case</span> <span class="string">'DECREMENT'</span>:</div><div class="line">            <span class="keyword">return</span> &#123; <span class="attr">value</span>: state.value - <span class="number">1</span> &#125;;</div><div class="line">        <span class="keyword">default</span>:</div><div class="line">            <span class="keyword">return</span> state;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Counter</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</div><div class="line">    <span class="comment">// State</span></div><div class="line">    <span class="keyword">constructor</span>(props) &#123;</div><div class="line">        <span class="keyword">super</span>(props)</div><div class="line">        <span class="keyword">this</span>.state = counter(<span class="literal">undefined</span>,&#123;&#125;)</div><div class="line">    &#125;</div><div class="line">  </div><div class="line">    dispatch(action) &#123;</div><div class="line">        <span class="keyword">this</span>.setState(<span class="function"><span class="params">prevState</span> =&gt;</span> counter(prevState, action));</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">// Action</span></div><div class="line">    increment = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">        <span class="keyword">this</span>.dispatch(&#123; <span class="attr">type</span>: <span class="string">'INCREMENT'</span> &#125;);</div><div class="line">    &#125;;</div><div class="line"></div><div class="line">    decrement = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">        <span class="keyword">this</span>.dispatch(&#123; <span class="attr">type</span>: <span class="string">'DECREMENT'</span> &#125;);</div><div class="line">    &#125;;</div><div class="line">  </div><div class="line">    render() &#123;</div><div class="line">        <span class="keyword">return</span> (</div><div class="line">            &lt;div&gt;</div><div class="line">                &#123;<span class="keyword">this</span>.state.value&#125;</div><div class="line">                &lt;button onClick=&#123;<span class="keyword">this</span>.increment&#125;&gt;+<span class="xml"><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></div><div class="line">                &lt;button onClick=&#123;<span class="keyword">this</span>.decrement&#125;&gt;-<span class="xml"><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></div><div class="line">            &lt;<span class="regexp">/div&gt;</span></div><div class="line"><span class="regexp">        )</span></div><div class="line"><span class="regexp">    &#125;</span></div><div class="line"><span class="regexp">&#125;</span></div></pre></td></tr></table></figure>
<p>最后：</p>
<ul>
<li>不要为了“用框架”而用框架</li>
<li>真正遇到需要这些工具来解决问题时再去实际应用</li>
<li><a href="http://cn.redux.js.org/" target="_blank" rel="external">Redux官网</a></li>
<li>你可能不需要用到Redux</li>
</ul>
<h3 id="Action"><a href="#Action" class="headerlink" title="Action"></a>Action</h3><p>Action 是带有type属性的js对象。<code>{ type: &#39;INCREMENT&#39; }</code>在Redux的应用操作中，我们要把所有改变应用状态的操作，规范为一个个Action。在Action当中，我们也可以赋上要用来修改应用状态state的具体数据<code>{ type: &#39;INCREMENT&#39;, num: 1 }</code>。上述我们可以看到两点Action的作用：</p>
<ul>
<li>定义我们的应用可以进行操作的动作或者操作的类型</li>
<li>传递改变引用状态的数据</li>
</ul>
<p>Action的定义要遵从一定的标准：<a href="https://github.com/acdlite/flux-standard-action" target="_blank" rel="external">Flux 标准 Action</a></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    <span class="comment">// Action 类型</span></div><div class="line">    type: <span class="string">'INCREMENT'</span>,</div><div class="line">    <span class="comment">// payload 中返回我们要传递的数据，用来修改state</span></div><div class="line">    paload: &#123;</div><div class="line">        num: <span class="number">1</span></div><div class="line">    &#125;,</div><div class="line">    <span class="comment">// payload 数据未获取成功时返回true</span></div><div class="line">    error:<span class="literal">false</span>,</div><div class="line">    <span class="comment">// 一些不必要在 paload 中传递的其他数据</span></div><div class="line">    meta: &#123;</div><div class="line">        success: <span class="literal">true</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>为了防止我们代码中出现很多写死的数值，减少hard code，可以使用Redux当中action creator的方法。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> counterActionGenerator = <span class="function">(<span class="params">type, num</span>) =&gt;</span> (num) =&gt; &#123;</div><div class="line">    <span class="keyword">let</span> action = &#123; type , num &#125;</div><div class="line">    <span class="keyword">return</span> action</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> addNumber = counterActionGenerator(<span class="string">'INCREMENT'</span>, <span class="literal">null</span> )</div><div class="line"><span class="keyword">const</span> minsNumber = counterActionGenerator(<span class="string">'DECREMENT'</span>, <span class="literal">null</span> )</div></pre></td></tr></table></figure>
<p>为了清晰的表达我们所有action动作，可以在应用的开头，或者一个独立的文件中定义所有的action type。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> INCREMENT = <span class="string">'INCREMENT'</span></div><div class="line"><span class="keyword">const</span> DECREMENT = <span class="string">'DECREMENT'</span></div></pre></td></tr></table></figure>
<ul>
<li>定义action类型的文件类似于一个说明文档，当你想要为应用添加新特性时，可以查阅应用已有的action类型，避免冲突。</li>
<li>在版本管理上也可以清晰看到action的记录的增删改查。</li>
<li>如果发现错误，在import就会发现代码报错，更快的进行调试。</li>
</ul>
<h3 id="Reducer"><a href="#Reducer" class="headerlink" title="Reducer"></a>Reducer</h3><p>在之前函数中定义了 counter 函数，它的内部时一个switch结构，接收两个参数，state 和 action ，并返回一个新的state 。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Reducer</span></div><div class="line"><span class="keyword">const</span> counter = <span class="function">(<span class="params">state = &#123; value: <span class="number">0</span> &#125;, action</span>) =&gt;</span> &#123;</div><div class="line">    <span class="keyword">switch</span> (action.type) &#123;</div><div class="line">        <span class="keyword">case</span> <span class="string">'INCREMENT'</span>:</div><div class="line">            <span class="keyword">return</span> &#123; <span class="attr">value</span>: state.value + <span class="number">1</span> &#125;;</div><div class="line">        <span class="keyword">case</span> <span class="string">'DECREMENT'</span>:</div><div class="line">            <span class="keyword">return</span> &#123; <span class="attr">value</span>: state.value - <span class="number">1</span> &#125;;</div><div class="line">        <span class="keyword">default</span>:</div><div class="line">            <span class="keyword">return</span> state;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>我们将上述的这个函数抽象为这个公式，更具业务现有的状态，更具触发的action ，返回新的状态的函数称之为 Reducer。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">(previousState, action ) =&gt; newState</div></pre></td></tr></table></figure>
<p>之所以将这样的函数称之为reducer，是因为这种函数与被传入 <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Array/Reduce" target="_blank" rel="external">Array.prototype.reduce(reducer, ?initialValue)</a>里的回调函数属于相同的类型。Reducer可以勉强翻译为缩减器或折叠器。</p>
<p>reduce属于一个高阶函数，它将其中的回调函数reducer递归应用到数组中的所有元素上，并返回一个独立的值，这就是缩减折叠的意义所在。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> sum = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].reduce(<span class="function"><span class="keyword">function</span>(<span class="params">acc, val</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> acc + val</div><div class="line">&#125;, <span class="number">0</span>)</div><div class="line"></div><div class="line"><span class="comment">/* 注意这里当中的回调函数(prev,curr) =&gt; prev + curr</span></div><div class="line"><span class="comment">*  与我们redux当中的reducer模型 (previousState, action ) =&gt; newState 看起来是不是很相似？</span></div><div class="line"><span class="comment">*/</span></div><div class="line">[<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>].reduce( <span class="function">(<span class="params">prev, curr</span>) =&gt;</span> prev + curr )</div><div class="line"></div><div class="line"><span class="keyword">const</span> todos = <span class="function">(<span class="params">state = [], action </span>) =&gt;</span> &#123;</div><div class="line">    <span class="keyword">switch</span> (action.type) &#123;</div><div class="line">        <span class="keyword">case</span> <span class="string">'ADD_TODO'</span>:</div><div class="line">            <span class="keyword">return</span> [</div><div class="line">            <span class="comment">//ES7对象扩展运算符写法</span></div><div class="line">            ...state,</div><div class="line">            &#123;</div><div class="line">                id:action:id,</div><div class="line">                text:action.text,</div><div class="line">                completed:<span class="literal">false</span></div><div class="line">            &#125;</div><div class="line">            ]</div><div class="line">        <span class="comment">// 不知道action类型的话返回默认state</span></div><div class="line">        <span class="keyword">default</span>:</div><div class="line">            <span class="keyword">return</span> state</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>reducer的主体，是一个switch结构的运算,他只是更具传入的state和action，来判断返回一个新的state。它必须是一个纯函数，不可以修改影响输入值（需要深拷贝），并且没有副作用（异步调用、影响作用域…)。永远不要在 reducer 里做这些操作：</p>
<ul>
<li>修改传入参数；</li>
<li>执行有副作用的操作，如 API 请求和路由跳转；</li>
<li>调用非纯函数，如 Date.now() 或 Math.random()。</li>
</ul>
<p>React应用当中数据发生改变，界面也要跟随相应改变，重新渲染，这这一步之间需要一个比较差异的diff操作，因此改变前后的数据都要被使用到。另外，实现一些诸如旅行的功能也需要依赖不可变数据。</p>
<h3 id="Store"><a href="#Store" class="headerlink" title="Store"></a>Store</h3><p>Store是我们存储状态数据state的地方，我们通过redux中createStore的方法，传入reducer函数来创建store。</p>
<ul>
<li>getState 获取当前状态数据</li>
<li>dispath 执行action</li>
<li>subscribe 订阅当前状态数据发生改变时触发的事件</li>
</ul>
<p>原生模拟createStore </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> createStore = <span class="function">(<span class="params">reducer</span>) =&gt;</span> &#123;</div><div class="line">    <span class="keyword">let</span> state;</div><div class="line">    <span class="keyword">let</span> listeners = [];</div><div class="line">    <span class="comment">// 返回当前的state</span></div><div class="line">    <span class="keyword">const</span> getState = <span class="function"><span class="params">()</span> =&gt;</span> state;</div><div class="line">    <span class="comment">// 根据action调用reducer返回新的state并触发listener</span></div><div class="line">    <span class="keyword">const</span> dispatch = <span class="function">(<span class="params">action</span>) =&gt;</span> &#123;</div><div class="line">        state = reducer(state,action);</div><div class="line">        listeners.forEach(<span class="function"><span class="params">listeners</span> =&gt;</span> listener())</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">/* 这里的subscribe有两个功能</span></div><div class="line"><span class="comment">    * 调用 subscribe(listener)会使用listeners.push(listener)注册一个listener</span></div><div class="line"><span class="comment">    * 调用 subscribe 的返回函数则会注销掉listener</span></div><div class="line"><span class="comment">    */</span></div><div class="line">    <span class="keyword">const</span> subscribe = <span class="function">(<span class="params">listener</span>) =&gt;</span> &#123;</div><div class="line">        listeners.push(listerer);</div><div class="line">        <span class="keyword">return</span> <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">            listeners = listerers.filter( <span class="number">1</span> =&gt; <span class="number">1</span> !== listener);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">// 返回三个主要方法</span></div><div class="line">    <span class="keyword">return</span> &#123; getState, dispatch, subscribe &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Middleware"><a href="#Middleware" class="headerlink" title="Middleware"></a>Middleware</h3><p>Middleware可以翻译为中间件，例如网站中某些访问限制的验证功能模块就可以当作一个middleware。Redux也可以应用middleware的概念实现一些例如日志记录调试输出等功能。</p>
<p>例如我们想知道数据前后发生的变化，最直接的办法 。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">console</span>.log(<span class="string">'prev state'</span>,store.getState())</div><div class="line">store.dispatch(action)</div><div class="line"><span class="built_in">console</span>.log(<span class="string">'next state'</span>,store.getState())</div></pre></td></tr></table></figure>
<p>手动修改dispath的方法 </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> store = createStore(counter)</div><div class="line"><span class="comment">// 将原本的dispatch方法保留并附上控制台语句</span></div><div class="line"><span class="keyword">let</span> next = store.dispatch</div><div class="line">store.dispatch = <span class="function"><span class="keyword">function</span> <span class="title">dispatchAndLog</span>(<span class="params">action</span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'prev state'</span>,store.getState())</div><div class="line">    <span class="keyword">let</span> result = next(action)</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'next state'</span>,store.getState())</div><div class="line">    <span class="keyword">return</span> result</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>直接修改dispath原生方法是比较脏的处理，并且有时候我们会使用多个middleware，所以我们需要把它与dispatch的逻辑拆分开来。在实际中可以再redux中引入applyMiddleware 方法 </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> &#123; createStore , applyMiddleware &#125; = Redux;</div><div class="line"><span class="keyword">const</span> loggerMiddleware = <span class="function"><span class="params">store</span> =&gt;</span> next =&gt; <span class="function"><span class="params">action</span> =&gt;</span> &#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'dispatching'</span>, action)</div><div class="line">    <span class="keyword">let</span> result = next(action)</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'next state'</span>, store.getState())</div><div class="line">    <span class="keyword">return</span> result</div><div class="line">&#125;</div><div class="line"><span class="keyword">const</span> store = createStore(counter,</div><div class="line">    applyMiddleware(loggerMiddleware))</div></pre></td></tr></table></figure>
<h3 id="react-redux"><a href="#react-redux" class="headerlink" title="react-redux"></a>react-redux</h3><p>react 和 redux 的使用 </p>
<p>在之前使用reat时，我们把数据放到state，通过setState可以触发react的更新渲染，而目前状态数据都交由redux管理。redux数据状态发生改变时，相应的是我们通过subscribe方法绑定的listener。所以我们需要绑定一个比较合适的监听函数作为状态变化时的相应，react提供了主动触发react更新渲染的方法<code>forceUpdate</code>。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'reat'</span></div><div class="line"><span class="keyword">import</span> ReactDOM <span class="keyword">from</span> <span class="string">'react-dom'</span></div><div class="line"><span class="keyword">import</span> &#123; createStore &#125; <span class="keyword">from</span> <span class="string">'redux'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> INCREMENT = <span class="string">'INCREMENT'</span></div><div class="line"><span class="keyword">const</span> DECREMENT = <span class="string">'DECREMENT'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> counter = <span class="function">(<span class="params">state = <span class="number">0</span>, action</span>) =&gt;</span> &#123;</div><div class="line">  <span class="keyword">switch</span> (action.type) &#123;</div><div class="line">    <span class="keyword">case</span> INCREMENT:</div><div class="line">      <span class="keyword">return</span> state + <span class="number">1</span>;</div><div class="line">    <span class="keyword">case</span> DECREMENT:</div><div class="line">      <span class="keyword">return</span> state - <span class="number">1</span>;</div><div class="line">    <span class="keyword">default</span>:</div><div class="line">      <span class="keyword">return</span> state;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> store = createStore(counter)</div><div class="line"></div><div class="line"><span class="comment">//展示组件</span></div><div class="line"><span class="keyword">const</span> Counter = (&#123; </div><div class="line">  count, onIncrement, onDecrement &#125;) =&gt; (</div><div class="line">  &lt;div&gt;</div><div class="line">    &lt;h1&gt;&#123;count&#125;&lt;<span class="regexp">/h1&gt;</span></div><div class="line"><span class="regexp">    &lt;button onClick=&#123;onIncrement&#125;&gt;+&lt;/</span>button&gt;</div><div class="line">    &lt;button onClick=&#123;onDecrement&#125;&gt;-<span class="xml"><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></div><div class="line">  &lt;<span class="regexp">/div&gt;</span></div><div class="line"><span class="regexp">)</span></div><div class="line"><span class="regexp"></span></div><div class="line"><span class="regexp">/</span><span class="regexp">/ 容器组件</span></div><div class="line"><span class="regexp">class CounterContainer extends React.Component &#123;</span></div><div class="line"><span class="regexp">    componentDidMount() &#123;</span></div><div class="line"><span class="regexp">        this.unsubscribe = store.subscribe( () = &gt; &#123;</span></div><div class="line"><span class="regexp">            this.forceUpdate()</span></div><div class="line"><span class="regexp">        &#125;)</span></div><div class="line"><span class="regexp">    &#125;</span></div><div class="line"><span class="regexp">    </span></div><div class="line"><span class="regexp">    componentWillUnmount() &#123;</span></div><div class="line"><span class="regexp">        this.unsubscribe()</span></div><div class="line"><span class="regexp">    &#125;</span></div><div class="line"><span class="regexp">    </span></div><div class="line"><span class="regexp">    render()&#123;</span></div><div class="line"><span class="regexp">        return &lt;Counter </span></div><div class="line"><span class="regexp">            value=&#123; store.getState() &#125; </span></div><div class="line"><span class="regexp">            onIncrement = &#123; () =&gt; store.dispatch(&#123;type: INCREMENT&#125;) &#125; </span></div><div class="line"><span class="regexp">            onDecrement = &#123; () =&gt; store.dispatch(&#123;type: DECREMENT&#125;) &#125; </span></div><div class="line"><span class="regexp">        /</span>&gt;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">&#125;</div><div class="line"></div><div class="line">ReactDOM.render(<span class="xml"><span class="tag">&lt;<span class="name">CounterContainer</span> /&gt;</span>,document.getElementById('root'))</span></div></pre></td></tr></table></figure>
<p>React是构建用户界面的框架，而Redux是为了解决状态管理问题专门开发的库，两者适合搭配但使用不是必须。React官方专门提供了连接react和redux的库，react-redux。react-redux主要提供两个方法</p>
<ul>
<li>provider 是向整个应用传递store容器组件</li>
<li>connect 方法可以更具用户展示组件自动生成对应容器组件</li>
</ul>
<p>provider就像我们传递store用的容器组件，一般都会套在应用组件的最外层。而connect方法可以根据我们现有的展示组件，自动生成容器组件。connect需要传递2个参数，mapStateToProps，用来对应state和props，并且传入参数时，在我们redux发生改变时，就会自动触发组件的更新。mapDispatchToProps，通过dispatch来传递对应的方法来触发action事件。connect在获取了redux的store之后，再更具我们传入的方法把我们需要的部分对应到props属性当中，再传递到我们的组件里。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'reat'</span></div><div class="line"><span class="keyword">import</span> ReactDOM <span class="keyword">from</span> <span class="string">'react-dom'</span></div><div class="line"><span class="keyword">import</span> &#123; createStore &#125; <span class="keyword">from</span> <span class="string">'redux'</span></div><div class="line"><span class="keyword">import</span> &#123; Provider ,connect &#125; = <span class="string">'react-redux'</span></div><div class="line"><span class="keyword">import</span> PropTypes <span class="keyword">from</span> <span class="string">'prop-types'</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">const</span> INCREMENT = <span class="string">'INCREMENT'</span></div><div class="line"><span class="keyword">const</span> DECREMENT = <span class="string">'DECREMENT'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> counter = <span class="function">(<span class="params">state = <span class="number">0</span>, action</span>) =&gt;</span> &#123;</div><div class="line">  <span class="keyword">switch</span> (action.type) &#123;</div><div class="line">    <span class="keyword">case</span> INCREMENT:</div><div class="line">      <span class="keyword">return</span> state + <span class="number">1</span>;</div><div class="line">    <span class="keyword">case</span> DECREMENT:</div><div class="line">      <span class="keyword">return</span> state - <span class="number">1</span>;</div><div class="line">    <span class="keyword">default</span>:</div><div class="line">      <span class="keyword">return</span> state;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> store = createStore(counter)</div><div class="line"></div><div class="line"><span class="comment">//展示组件</span></div><div class="line"><span class="keyword">const</span> Counter = (&#123; </div><div class="line">  count, onIncrement, onDecrement &#125;) =&gt; (</div><div class="line">  &lt;div&gt;</div><div class="line">    &lt;h1&gt;&#123;count&#125;&lt;<span class="regexp">/h1&gt;</span></div><div class="line"><span class="regexp">    &lt;button onClick=&#123;onIncrement&#125;&gt;+&lt;/</span>button&gt;</div><div class="line">    &lt;button onClick=&#123;onDecrement&#125;&gt;-<span class="xml"><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></div><div class="line">  &lt;<span class="regexp">/div&gt;</span></div><div class="line"><span class="regexp">)</span></div><div class="line"><span class="regexp"></span></div><div class="line"><span class="regexp">Counter.propTypes = &#123;</span></div><div class="line"><span class="regexp">    count: PropTypes.number.isRequired,</span></div><div class="line"><span class="regexp">    onIncrement: PropTypes.func.isRequired,</span></div><div class="line"><span class="regexp">    onDecrement: PropTypes.func.isRequired,</span></div><div class="line"><span class="regexp">&#125;</span></div><div class="line"><span class="regexp"></span></div><div class="line"><span class="regexp">const = mapStateToProps = (state) =&gt; (</span></div><div class="line"><span class="regexp">    &#123;</span></div><div class="line"><span class="regexp">        count:state</span></div><div class="line"><span class="regexp">    &#125;</span></div><div class="line"><span class="regexp">)</span></div><div class="line"><span class="regexp"></span></div><div class="line"><span class="regexp">const = mapDispatchToProps = (dispatch) =&gt; &#123;</span></div><div class="line"><span class="regexp">    onIncrement: () =&gt; &#123;</span></div><div class="line"><span class="regexp">        dispatch(&#123;type: INCREMENT&#125;)</span></div><div class="line"><span class="regexp">    &#125;,</span></div><div class="line"><span class="regexp">    onDecrement: () =&gt; &#123;</span></div><div class="line"><span class="regexp">        dispatch(&#123;type: DECREMENT&#125;)</span></div><div class="line"><span class="regexp">    &#125;</span></div><div class="line"><span class="regexp">&#125;</span></div><div class="line"><span class="regexp"></span></div><div class="line"><span class="regexp">/</span><span class="regexp">/ 容器组件</span></div><div class="line"><span class="regexp">const CounterContainer = connect(mapStateToProps, mapDispatchToProps)(Counter)</span></div><div class="line"><span class="regexp"></span></div><div class="line"><span class="regexp">ReactDOM.render(</span></div><div class="line"><span class="regexp">    &lt;Provider store=&#123;store&#125;&gt;</span></div><div class="line"><span class="regexp">        &lt;CounterContainer /</span>&gt;</div><div class="line">    &lt;<span class="regexp">/Provider&gt;</span></div><div class="line"><span class="regexp">    ,document.getElementById('root'))</span></div></pre></td></tr></table></figure>
<p>react-redux实现了很多优化，不会像ReactDOM.render和 foreUpdate一样耗费效率，正式开发中建议使用react-redux。</p>
<h2 id="react-router-4"><a href="#react-router-4" class="headerlink" title="react-router 4"></a>react-router 4</h2><h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p>在web开发中，前端扮演着越来越重要的角色。路由功能可以由前端来实现，无需后端返回页面，通过前端路由实现URL的改变以及对页面的切换。较早之前实现前端路由的方法，在Angular1中时通过hash(#)来处理，也就是带#号的锚点。前端路由多种多样，我们还可以通过操作DOM的<a href="https://developer.mozilla.org/zh-CN/docs/Web/API/History" target="_blank" rel="external">histroy</a>对象，使用<code>history.pushState</code>,<code>window.onpopstate</code>这2个方法来实现。</p>
<p>前端路由主要实现2个部分的功能：</p>
<ul>
<li>改变当前URL地址</li>
<li>更具URL地址对当前页面进行切换</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"/home"</span>&gt;</span>Home<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"/blog"</span>&gt;</span>Blog<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"/about"</span>&gt;</span>About<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">h2</span>&gt;</span>History state:<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">"state"</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 修改 history pushState</span></div><div class="line">(<span class="function"><span class="keyword">function</span>(<span class="params">history</span>)</span>&#123;</div><div class="line">    <span class="keyword">var</span> pushState = history.pushState;</div><div class="line">    history.pushState = <span class="function"><span class="keyword">function</span>(<span class="params">state</span>) </span>&#123;</div><div class="line">        <span class="keyword">if</span> (<span class="keyword">typeof</span> history.onpushstate == <span class="string">"function"</span>) &#123;</div><div class="line">            history.onpushstate(&#123;<span class="attr">state</span>: state&#125;);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> pushState.apply(history, <span class="built_in">arguments</span>);</div><div class="line">    &#125;</div><div class="line">&#125;)(<span class="built_in">window</span>.history);</div><div class="line"><span class="comment">// 添加触发事件</span></div><div class="line"><span class="built_in">window</span>.onpopstate = history.onpushstate = <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</div><div class="line">  <span class="built_in">document</span>.getElementById(<span class="string">'state'</span>).innerHTML = <span class="string">"location: "</span> + <span class="built_in">document</span>.location + <span class="string">", state: "</span> + <span class="built_in">JSON</span>.stringify(event.state);</div><div class="line">&#125;</div><div class="line"><span class="comment">// 为链接绑定事件处理函数，阻止页面跳转，触发pushState</span></div><div class="line"><span class="keyword">var</span> links = <span class="built_in">document</span>.getElementsByTagName(<span class="string">'a'</span>);</div><div class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; links.length; i++) &#123;</div><div class="line">    links[i].onclick = <span class="function"><span class="keyword">function</span> (<span class="params">event</span>) </span>&#123;</div><div class="line">        event.preventDefault();</div><div class="line">        <span class="keyword">var</span> route = event.target.getAttribute(<span class="string">'href'</span>);</div><div class="line">        history.pushState(&#123;<span class="attr">page</span>: route&#125;, route, route);</div><div class="line">        <span class="built_in">console</span>.log(<span class="string">'current state'</span>, history.state)</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>react-router为我们提供预制的，可以实现功能的组件，使用方法和react组件保持一致，只需要我们在应用的时候加上一些JSX的标签。react-router目前已出了4个版本，而且不同版本直接差异也比较大。目前4.0版本中包含三个主要的库：</p>
<ul>
<li>react-router-dom(web)</li>
<li>react-router-native(rn)</li>
<li>react-router(core)</li>
</ul>
<p>react-router-dom和react-router-native相当于在react-router之上又封装了一层。让我们来关注并且手动配置的部分更少了，一般如果开发web应用的话，react-router-dom就足够了。</p>
<p>我们从react-router-dom中引入三个组件，BroswerRouter、Router、Link，这个组件都是react组件。首先把BrowswerRouter放到最外层，这是给我们应用添加路由功能的容器组件，之后在我们觉得合适的地方添加link组件，link组件的to属性就是对应路由的地址，最后使用Router来添加正式的路由。每个Router的path属性也是对应路由的地址，点击对应的link，就会跳转到对应的路由中。Router的component属性，就是路由跳转过来显示的组件。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> &#123; BrowserRouter, Route, Link &#125; = ReactRouterDOM</div><div class="line"></div><div class="line"><span class="keyword">const</span> BasicExample = <span class="function"><span class="params">()</span> =&gt;</span> (</div><div class="line">    &lt;BrowserRouter&gt;</div><div class="line">        &lt;div&gt;</div><div class="line">            &lt;ul&gt;</div><div class="line">                &lt;li&gt;<span class="xml"><span class="tag">&lt;<span class="name">Link</span> <span class="attr">exact</span> <span class="attr">to</span>=<span class="string">"/"</span>&gt;</span>Home<span class="tag">&lt;/<span class="name">Link</span>&gt;</span></span><span class="xml"><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></div><div class="line">                &lt;li&gt;<span class="xml"><span class="tag">&lt;<span class="name">Link</span> <span class="attr">exact</span> <span class="attr">to</span>=<span class="string">"/about"</span>&gt;</span>About<span class="tag">&lt;/<span class="name">Link</span>&gt;</span></span><span class="xml"><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></div><div class="line">                &lt;li&gt;<span class="xml"><span class="tag">&lt;<span class="name">Link</span> <span class="attr">to</span>=<span class="string">"/topics"</span>&gt;</span>Topics<span class="tag">&lt;/<span class="name">Link</span>&gt;</span></span><span class="xml"><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></div><div class="line">            &lt;<span class="regexp">/ul&gt;</span></div><div class="line"><span class="regexp"></span></div><div class="line"><span class="regexp">            &lt;Route exact path="/</span><span class="string">" component=&#123;Home&#125;/&gt;</span></div><div class="line"><span class="string">            &lt;Route exact path="</span>/about<span class="string">" component=&#123;About&#125;/&gt;</span></div><div class="line"><span class="string">            &lt;Route path="</span>/topics<span class="string">" component=&#123;Topics&#125;/&gt;</span></div><div class="line"><span class="string">        &lt;/div&gt;</span></div><div class="line"><span class="string">    &lt;/BrowserRouter&gt;</span></div><div class="line"><span class="string">)</span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string">const Home = () =&gt; (</span></div><div class="line"><span class="string">    &lt;div&gt;&lt;h2&gt;Home&lt;/h2&gt;&lt;/div&gt;</span></div><div class="line"><span class="string">)</span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string">const About = () =&gt; (</span></div><div class="line"><span class="string">    &lt;div&gt;&lt;h2&gt;About&lt;/h2&gt;&lt;/div&gt;</span></div><div class="line"><span class="string">)</span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string">const Topics = (&#123; match &#125;) =&gt; (</span></div><div class="line"><span class="string">    &lt;div&gt;&lt;h2&gt;Topics&lt;/h2&gt;&lt;/div&gt;</span></div><div class="line"><span class="string">)</span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string">ReactDOM.render(&lt;BasicExample /&gt;, document.getElementById('root'))</span></div></pre></td></tr></table></figure>
<h3 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h3><h4 id="BrowserRouter"><a href="#BrowserRouter" class="headerlink" title="BrowserRouter"></a>BrowserRouter</h4><p>主要实现页面功能与URL同步的功能，新版本的BrowserRouter内置对浏览器histroy的支持，不需要我们做任何的配置就可以正常使用，并且没有#号，也不会生成随机字符串。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; BrowserRouter &#125; <span class="keyword">from</span> <span class="string">'react-router-dom'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> Root = <span class="function"><span class="params">()</span> =&gt;</span> (</div><div class="line">    &lt;BrowserRouter&gt;</div><div class="line">        &lt;App/&gt;</div><div class="line">    &lt;<span class="regexp">/BrowserRouter&gt;</span></div><div class="line"><span class="regexp">)</span></div><div class="line"><span class="regexp"></span></div><div class="line"><span class="regexp">const App = () =&gt; (</span></div><div class="line"><span class="regexp">    &lt;div&gt;&lt;h1&gt;Hello, react-route !&lt;/</span>h1&gt;<span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></div><div class="line">)</div><div class="line"></div><div class="line">ReactDOM.render(<span class="xml"><span class="tag">&lt;<span class="name">Root</span>/&gt;</span></span>,<span class="built_in">document</span>.getElementById(<span class="string">'root'</span>))</div></pre></td></tr></table></figure>
<h4 id="Route"><a href="#Route" class="headerlink" title="Route"></a>Route</h4><p>Route是路由组件，一般接受2个参数，path 和 component，用来制定路由的URL已经所要渲染的组件。exact 属性，添加后只会匹配到path的根地址。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> BasicExample = <span class="function"><span class="params">()</span> =&gt;</span> (</div><div class="line">    &lt;BrowserRouter&gt;</div><div class="line">        &lt;div&gt;</div><div class="line">            &lt;ul&gt;</div><div class="line">                &lt;li&gt;<span class="xml"><span class="tag">&lt;<span class="name">Link</span> <span class="attr">exact</span> <span class="attr">to</span>=<span class="string">"/"</span>&gt;</span>Home<span class="tag">&lt;/<span class="name">Link</span>&gt;</span></span><span class="xml"><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></div><div class="line">                &lt;li&gt;<span class="xml"><span class="tag">&lt;<span class="name">Link</span> <span class="attr">exact</span> <span class="attr">to</span>=<span class="string">"/about"</span>&gt;</span>About<span class="tag">&lt;/<span class="name">Link</span>&gt;</span></span><span class="xml"><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></div><div class="line">                &lt;li&gt;<span class="xml"><span class="tag">&lt;<span class="name">Link</span> <span class="attr">to</span>=<span class="string">"/topics"</span>&gt;</span>Topics<span class="tag">&lt;/<span class="name">Link</span>&gt;</span></span><span class="xml"><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></div><div class="line">            &lt;<span class="regexp">/ul&gt;</span></div><div class="line"><span class="regexp"></span></div><div class="line"><span class="regexp">            &lt;Route exact path="/</span><span class="string">" component=&#123;Home&#125;/&gt;</span></div><div class="line"><span class="string">            &lt;Route exact path="</span>/about<span class="string">" component=&#123;About&#125;/&gt;</span></div><div class="line"><span class="string">            &lt;Route path="</span>/topics<span class="string">" component=&#123;Topics&#125;/&gt;</span></div><div class="line"><span class="string">        &lt;/div&gt;</span></div><div class="line"><span class="string">    &lt;/BrowserRouter&gt;</span></div><div class="line"><span class="string">)</span></div></pre></td></tr></table></figure>
<h4 id="Link"><a href="#Link" class="headerlink" title="Link"></a>Link</h4><p>Link是最基本的导航连接组件，我们只需要使用to参数，指向我们要使用的路由即可。在我们使用当中，会经常为我们的导航使用不同的样式，这就需要使用的NavLink，并加上导航使用的激活属性activeStyle。组件接收match对象包含以下几项属性：</p>
<ul>
<li>params 预设url中传递的参数</li>
<li>isExact 当前url是否绝对匹配此路由</li>
<li>path 路由设定的path值</li>
<li>url 当前url地址</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; BrowserRouter &#125; <span class="keyword">from</span> <span class="string">'react-router-dom'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> Root = <span class="function"><span class="params">()</span> =&gt;</span> (</div><div class="line">    &lt;BrowserRouter&gt;</div><div class="line">        &lt;App/&gt;</div><div class="line">    &lt;<span class="regexp">/BrowserRouter&gt;</span></div><div class="line"><span class="regexp">)</span></div><div class="line"><span class="regexp"></span></div><div class="line"><span class="regexp">const App = () =&gt; (</span></div><div class="line"><span class="regexp">    &lt;div&gt;</span></div><div class="line"><span class="regexp">        &lt;ul&gt;</span></div><div class="line"><span class="regexp">            &lt;li&gt;&lt;NavLink activeStyle=&#123;&#123;fontWeight:'Bold'&#125;&#125;  to="/</span>repo/react&gt;Repo:react&lt;<span class="regexp">/NavLink&gt;&lt;/</span>li&gt;</div><div class="line">            &lt;li&gt;<span class="xml"><span class="tag">&lt;<span class="name">NavLink</span> <span class="attr">activeStyle</span>=<span class="string">&#123;&#123;fontWeight:</span>'<span class="attr">Bold</span>'&#125;&#125;  <span class="attr">to</span>=<span class="string">"/repo/vue&gt;</span></span></span>Repo:vue&lt;<span class="regexp">/NavLink&gt;&lt;/</span>li&gt;</div><div class="line">            &lt;li&gt;<span class="xml"><span class="tag">&lt;<span class="name">NavLink</span> <span class="attr">activeStyle</span>=<span class="string">&#123;&#123;fontWeight:</span>'<span class="attr">Bold</span>'&#125;&#125;  <span class="attr">to</span>=<span class="string">"/repo/angular&gt;</span></span></span>Repo:angular&lt;<span class="regexp">/NavLink&gt;&lt;/</span>li&gt;</div><div class="line">        &lt;<span class="regexp">/ul&gt;</span></div><div class="line"><span class="regexp">        </span></div><div class="line"><span class="regexp">        &lt;Route path='/</span>repo/:repoName?<span class="string">' component=&#123;Repo&#125; /&gt;</span></div><div class="line"><span class="string">    &lt;/div&gt;</span></div><div class="line"><span class="string">)</span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string">const Repo = (&#123;match&#125;) =&gt; (</span></div><div class="line"><span class="string">    &lt;div&gt;&lt;p&gt;&#123;match.params.repoName&#125;&lt;/p&gt;&lt;/div&gt;</span></div><div class="line"><span class="string">)</span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string">ReactDOM.render(&lt;Root/&gt;,document.getElementById('</span>root<span class="string">'))</span></div></pre></td></tr></table></figure>
<p>除了通过组件的参数获取外，还可以通过withRouter方法来获取</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> Title = <span class="function">(<span class="params">&#123;match&#125;</span>) =&gt;</span> (</div><div class="line">    &lt;h1&gt;&#123;match.params.repo&#125;&lt;<span class="regexp">/h1&gt;</span></div><div class="line"><span class="regexp">)</span></div><div class="line"><span class="regexp">Title = withRouter(Title)</span></div></pre></td></tr></table></figure>
<h2 id="CSS"><a href="#CSS" class="headerlink" title="CSS"></a>CSS</h2><h3 id="css样式编写的方法"><a href="#css样式编写的方法" class="headerlink" title="css样式编写的方法"></a>css样式编写的方法</h3><ul>
<li>css in js <a href="https://developer.mozilla.org/en-US/docs/web/css/css_properties_reference" target="_blank" rel="external">(css名称)</a></li>
<li>外部引用css，然后为组件定义对应的className属性。</li>
</ul>
<p>css in js,是由facebook提出的在由React开发的背景下。css in js，允许我们在变量当中定义样式，通过定义内联样式直接将每个组件的样式写在每个组件的js当中。通过利用js语言本身的特性，不必担心样式的作用域或者是复用性之类的问题。在传统的web开发认为应该尽量使用外联样式，与页面结构分离。但组件化的思想中，同一个组件应该在内部定义逻辑／结构／样式。分而治之，进近维护，独立文件，外部引用。</p>
<h4 id="Modules-Sass-PostCSS-在React项目中的应用"><a href="#Modules-Sass-PostCSS-在React项目中的应用" class="headerlink" title="Modules/Sass/PostCSS 在React项目中的应用"></a>Modules/Sass/PostCSS 在React项目中的应用</h4><h4 id="Modules"><a href="#Modules" class="headerlink" title="Modules"></a>Modules</h4><p>create-react-app已经把我们把所有配置都封装号，如果我们希望改变的话，就需要获取配置文件，在项目中<code>run eject</code>,在目录下生成config文件，webpack.config.dev.js和webpack.config.prod.js。</p>
<p>我们用命令行创建的react项目当中，默认已经包含了使用CSS Modules的所有依赖，需要我们修改配置才能生效。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    loader: <span class="built_in">require</span>.resolve(<span class="string">'css-loader'</span>),</div><div class="line">    options: &#123;</div><div class="line">        importLoaders: <span class="number">1</span>,</div><div class="line">        modules:<span class="literal">true</span>,</div><div class="line">        localIdentName: <span class="string">'[path][name]__[local]--[hash:base64:5]'</span></div><div class="line">    &#125;,</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>然后就可以通过import来引入样式了，就可以在className对应的类名下使用了。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> styles <span class="keyword">from</span> <span class="string">'./App.css'</span></div></pre></td></tr></table></figure>
<h4 id="sass"><a href="#sass" class="headerlink" title="sass"></a>sass</h4><p>如果像使用sass，就要添加对应的sass加载器。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install sass-loader node-sass --save-dev</div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    test:<span class="regexp">/\.scss$/</span>,</div><div class="line">    include:paths.appSrc,</div><div class="line">    loaders:[</div><div class="line">        <span class="built_in">require</span>.resolve(<span class="string">'style-loader'</span>),</div><div class="line">        <span class="built_in">require</span>.resolve(<span class="string">'css-loader'</span>),</div><div class="line">        <span class="built_in">require</span>.resolve(<span class="string">'sass-loader'</span>),</div><div class="line">    ]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="postcss"><a href="#postcss" class="headerlink" title="postcss"></a>postcss</h4><p>是一个加载css插件的平台，比起一些预先定制好的加载器，postcss更加的灵活。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">npm install autoprefixer postcss-initial postcss-import postcss-mixins postcss-nested postcss-simple-vars postcss-math postcss-color-function --save-dev</div><div class="line">配置 postcss.config.js</div><div class="line">新建src文件夹，配置 variables.js 和 mixins.js</div><div class="line">在 webpack.config 中引入 postcss 配置</div></pre></td></tr></table></figure>
<p><strong>webpack.config</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    loader: <span class="built_in">require</span>.resolve(<span class="string">'postcss-loader'</span>),</div><div class="line">    options: &#123;</div><div class="line">        config: &#123;</div><div class="line">            path:<span class="string">'./config/postcss.config.js'</span></div><div class="line">        &#125;</div><div class="line">    &#125;,</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>postcss.config.js</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">module</span>.exports = &#123;</div><div class="line">  plugins: &#123;</div><div class="line">    <span class="comment">/* autoprefix for different browser vendors */</span></div><div class="line">    <span class="string">'autoprefixer'</span>: &#123;&#125;,</div><div class="line">    <span class="comment">/* reset inherited rules */</span></div><div class="line">    <span class="string">'postcss-initial'</span>:&#123;</div><div class="line">      reset: <span class="string">'inherited'</span> <span class="comment">// reset only inherited rules</span></div><div class="line">    &#125;,</div><div class="line">    <span class="comment">/* enable css @imports like Sass/Less */</span></div><div class="line">    <span class="string">'postcss-import'</span>: &#123;&#125;,</div><div class="line">    <span class="comment">/* enable mixins like Sass/Less */</span></div><div class="line">    <span class="string">'postcss-mixins'</span>:&#123;</div><div class="line">      mixins: <span class="built_in">require</span>(<span class="string">'./src/mixins'</span>)</div><div class="line">    &#125;,</div><div class="line">    <span class="comment">/* enable nested css selectors like Sass/Less */</span></div><div class="line">    <span class="string">'postcss-nested'</span>:&#123;&#125;,</div><div class="line">    <span class="comment">/* require global variables */</span></div><div class="line">    <span class="string">'postcss-simple-vars'</span>:&#123;</div><div class="line">      variables: <span class="function"><span class="keyword">function</span> <span class="title">variables</span>(<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="built_in">require</span>(<span class="string">'./src/variables'</span>)</div><div class="line">      &#125;,</div><div class="line">      unknown: <span class="function"><span class="keyword">function</span> <span class="title">unknown</span>(<span class="params">node, name, result</span>) </span>&#123;</div><div class="line">        node.warn(result, <span class="string">'Unknown variable '</span> + name)</div><div class="line">      &#125;</div><div class="line">    &#125;,</div><div class="line">    <span class="comment">/* PostCSS plugin for making calculations with math.js  */</span></div><div class="line">    <span class="string">'postcss-math'</span>:&#123;&#125;,</div><div class="line">    <span class="comment">/* transform W3C CSS color function to more compatible CSS. */</span></div><div class="line">    <span class="string">'postcss-color-function'</span>:&#123;&#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>mixins.js</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// src/mixins.js</span></div><div class="line"><span class="keyword">var</span> globalMixins = &#123;</div><div class="line">  <span class="comment">/* noSelect is a static mixin  */</span></div><div class="line">  noSelect: &#123;</div><div class="line">    <span class="string">'-webkit-touch-callout'</span>: <span class="string">'none'</span>,</div><div class="line">    <span class="string">'-webkit-user-select'</span>: <span class="string">'none'</span>,</div><div class="line">    <span class="string">'-khtml-user-select'</span>: <span class="string">'none'</span>,</div><div class="line">    <span class="string">'-moz-user-select'</span>: <span class="string">'none'</span>,</div><div class="line">    <span class="string">'-ms-user-select'</span>: <span class="string">'none'</span>,</div><div class="line">    <span class="string">'user-select'</span>: <span class="string">'none'</span></div><div class="line">  &#125;,</div><div class="line">  <span class="comment">/* OpenSans is a dynamic mixin  */</span></div><div class="line">  OpenSans: <span class="function"><span class="keyword">function</span> (<span class="params">obj, value</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">      <span class="string">'font-family'</span>: <span class="string">'Open Sans, sans-serif'</span>,</div><div class="line">      <span class="string">'font-style'</span>: <span class="string">'normal'</span>,</div><div class="line">      <span class="string">'font-size'</span>: value,</div><div class="line">      <span class="string">'font-weight'</span>: <span class="number">200</span>,</div><div class="line">      <span class="string">'-webkit-font-smoothing'</span>: <span class="string">'antialiased'</span>,</div><div class="line">      <span class="string">'-moz-osx-font-smoothing'</span>: <span class="string">'grayscale'</span></div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"><span class="built_in">module</span>.exports = globalMixins</div></pre></td></tr></table></figure>
<p>variables.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> globalVariable = &#123;</div><div class="line">  primary: <span class="string">'blue'</span></div><div class="line">&#125;</div><div class="line"><span class="built_in">module</span>.exports = globalVariable</div></pre></td></tr></table></figure>
<p><strong>App.css</strong></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.App-intro</span>&#123;</div><div class="line">    <span class="attribute">color</span>:$primary;</div><div class="line">    @mixin noSelect;</div><div class="line">    @<span class="keyword">mixin</span> OpenSans <span class="number">30px</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="实战TodoList"><a href="#实战TodoList" class="headerlink" title="实战TodoList"></a>实战TodoList</h2><h3 id="开发前准备"><a href="#开发前准备" class="headerlink" title="开发前准备"></a>开发前准备</h3><p>环境</p>
<ul>
<li><a href="https://nodejs.org/zh-cn/" target="_blank" rel="external">node</a></li>
<li><a href="https://github.com/facebookincubator/create-react-app" target="_blank" rel="external">create-react-app</a></li>
</ul>
<p>初始化项目</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">cd</span> Desktop </div><div class="line">create-react-app todo</div></pre></td></tr></table></figure>
<p>删除src目录上的所有文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">cd</span> src  &amp;&amp; rm -rf *</div></pre></td></tr></table></figure>
<p>创建Components 及 Containers 文件夹</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">mkdir Components</div><div class="line">mkdir Containers</div></pre></td></tr></table></figure>
<p>在Components上创建 TodoApp.js</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">cd</span> Components &amp;&amp; touch TodoApp.js</div><div class="line">vim TodoApp.js</div></pre></td></tr></table></figure>
<p><strong>TodoApp.js</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React, &#123; Component &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">TodoApp</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</div><div class="line">    render() &#123;</div><div class="line">        <span class="keyword">return</span> (</div><div class="line">            &lt;div&gt;Hello, React!<span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></div><div class="line">        );</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> TodoApp;</div></pre></td></tr></table></figure>
<p>在src目录下创建index.js并引用TodoApp.js</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">cd</span> .. &amp;&amp; touch index.js</div><div class="line">vim index.js</div></pre></td></tr></table></figure>
<p><strong>index.js</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"><span class="keyword">import</span> ReactDOM <span class="keyword">from</span> <span class="string">'react-dom'</span>;</div><div class="line"><span class="keyword">import</span> TodoApp <span class="keyword">from</span> <span class="string">'./Components/TodoApp'</span></div><div class="line"></div><div class="line">ReactDOM.render(<span class="xml"><span class="tag">&lt;<span class="name">TodoApp</span> /&gt;</span>, document.getElementById('root'));</span></div></pre></td></tr></table></figure>
<h3 id="组件开发"><a href="#组件开发" class="headerlink" title="组件开发"></a>组件开发</h3><p>在📁Component中创建AddTodo.js，把标题和输入框都放在其中。</p>
<p><strong>AddTodo.js</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> AddTodo = <span class="function"><span class="params">()</span> =&gt;</span> (</div><div class="line">    &lt;header&gt;</div><div class="line">        &lt;h1&gt;Todos&lt;<span class="regexp">/h1&gt;</span></div><div class="line"><span class="regexp">        &lt;input placeholder="接下来做什么？" autoFocus /</span>&gt;</div><div class="line">    &lt;<span class="regexp">/header&gt;</span></div><div class="line"><span class="regexp">);</span></div><div class="line"><span class="regexp"></span></div><div class="line"><span class="regexp">export default AddTodo;</span></div></pre></td></tr></table></figure>
<p>在📁Component中创建TodoList.js，列表组件。涉及到React当中的列表渲染，我们把列表中的每一个元素设为Todo.js组件，然后TodoList接收props，使用map方法渲染出每一项Todo。</p>
<p><strong>TodoList.js</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"><span class="keyword">import</span> Todo <span class="keyword">from</span> <span class="string">'./Todo'</span>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> TodoList = <span class="function">(<span class="params">&#123; todos &#125;</span>) =&gt;</span> (</div><div class="line">    &lt;ul&gt;</div><div class="line">        &#123;todos.map(<span class="function">(<span class="params">todo</span>) =&gt;</span> (</div><div class="line">            &lt;Todo key=&#123;todo.id&#125; content=&#123;todo.content&#125; /&gt;</div><div class="line">        ))&#125;</div><div class="line">    &lt;<span class="regexp">/ul&gt;</span></div><div class="line"><span class="regexp">);</span></div><div class="line"><span class="regexp"></span></div><div class="line"><span class="regexp">export default TodoList;</span></div></pre></td></tr></table></figure>
<p><strong>Todo.js</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> Todo = <span class="function">(<span class="params">&#123; content &#125;</span>) =&gt;</span> (</div><div class="line">    &lt;li&gt;</div><div class="line">        &lt;div&gt;</div><div class="line">            &lt;input type=<span class="string">"checkbox"</span> /&gt;</div><div class="line">            &lt;label href=<span class="string">"/#"</span>&gt;&#123;content&#125;&lt;<span class="regexp">/label&gt;</span></div><div class="line"><span class="regexp">        &lt;/</span>div&gt;</div><div class="line">    &lt;<span class="regexp">/li&gt; </span></div><div class="line"><span class="regexp">);</span></div><div class="line"><span class="regexp"></span></div><div class="line"><span class="regexp">export default Todo;</span></div></pre></td></tr></table></figure>
<p>在📁Component中创建Footer.js，导航组件。包含全部、代办、已完成，并且把当中的每一项封装为Link组件。由于这三项的内容都是固定的，所以我们直接重复引用三次Link组件即可。</p>
<p><strong>Footer.js</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"><span class="keyword">import</span> Link <span class="keyword">from</span> <span class="string">'./Link'</span>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> Footer = <span class="function"><span class="params">()</span> =&gt;</span> (</div><div class="line">    &lt;footer&gt;</div><div class="line">        &lt;ul&gt;</div><div class="line">            &lt;Link filter=<span class="string">"all"</span>&gt;全部&lt;<span class="regexp">/Link&gt;</span></div><div class="line"><span class="regexp">            &lt;Link filter="active"&gt;待办&lt;/</span>Link&gt;</div><div class="line">            &lt;Link filter=<span class="string">"completed"</span>&gt;已完成&lt;<span class="regexp">/Link&gt;</span></div><div class="line"><span class="regexp">        &lt;/u</span>l&gt;</div><div class="line">    &lt;<span class="regexp">/footer&gt;</span></div><div class="line"><span class="regexp">);</span></div><div class="line"><span class="regexp"></span></div><div class="line"><span class="regexp">export default Footer;</span></div></pre></td></tr></table></figure>
<p><strong>Link.js</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> Link = <span class="function">(<span class="params">&#123; children &#125;</span>) =&gt;</span> (</div><div class="line">    &lt;li&gt;</div><div class="line">        &lt;a href=<span class="string">"/#"</span>&gt;&#123;children&#125;&lt;<span class="regexp">/a&gt;</span></div><div class="line"><span class="regexp">    &lt;/</span>li&gt;</div><div class="line">);</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> Link;</div></pre></td></tr></table></figure>
<p>在src目录下创建store.js，用来模拟临时数据</p>
<p><strong>store.js</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> todos = [</div><div class="line">    &#123; </div><div class="line">        id: <span class="number">1</span>,</div><div class="line">        content: <span class="string">"学习 React"</span></div><div class="line">    &#125;,</div><div class="line">    &#123; </div><div class="line">        id: <span class="number">2</span>,</div><div class="line">        content: <span class="string">"学习 Redux"</span></div><div class="line">    &#125;,</div><div class="line">    &#123; </div><div class="line">        id: <span class="number">3</span>,</div><div class="line">        content: <span class="string">"学习 react-router"</span></div><div class="line">    &#125;,</div><div class="line">];</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> todos;</div></pre></td></tr></table></figure>
<p>修改应用主文件TodoApp.js，引入编写的三个模块，以及store数据。把store数据传入TodoList中。</p>
<p><strong>TodoApp.js</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React    <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"></div><div class="line"><span class="keyword">import</span> AddTodo  <span class="keyword">from</span> <span class="string">'./AddTodo'</span>;</div><div class="line"><span class="keyword">import</span> TodoList <span class="keyword">from</span> <span class="string">'./TodoList'</span>;</div><div class="line"><span class="keyword">import</span> Footer   <span class="keyword">from</span> <span class="string">'./Footer'</span>;</div><div class="line"><span class="keyword">import</span> todos    <span class="keyword">from</span> <span class="string">'../store.js'</span>;</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">const</span> TodoApp = <span class="function"><span class="params">()</span> =&gt;</span> (</div><div class="line">    &lt;section&gt;</div><div class="line">        &lt;AddTodo/&gt;</div><div class="line">        &lt;TodoList todos=&#123;todos&#125;/&gt;</div><div class="line">        &lt;Footer/&gt;</div><div class="line">    &lt;<span class="regexp">/section&gt;</span></div><div class="line"><span class="regexp">);</span></div><div class="line"><span class="regexp"></span></div><div class="line"><span class="regexp">export default TodoApp;</span></div></pre></td></tr></table></figure>
<h3 id="样式"><a href="#样式" class="headerlink" title="样式"></a>样式</h3><p>借用 <a href="https://github.com/tastejs/todomvc-app-css" target="_blank" rel="external">todomvc-app-css</a> 来进行样式填充，然后对应的添加className。</p>
<blockquote>
<p>此处我们仅仅是为了页面的美观，如果对样式没有要求，只关注功能，可以跳过。</p>
</blockquote>
<p>通过npm安装</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install todomvc-app-css --save</div></pre></td></tr></table></figure>
<p>然后更具 <a href="https://github.com/tastejs/todomvc-app-template/blob/master/index.html" target="_blank" rel="external">todomvc-html</a>里为我们的Todo应用对应添加上className。</p>
<p><strong>TodoApp.js</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> TodoApp = <span class="function"><span class="params">()</span> =&gt;</span> (</div><div class="line">    &lt;section className=<span class="string">"todoapp"</span> &gt;</div><div class="line">        &lt;AddTodo/&gt;</div><div class="line">        &lt;TodoList todos=&#123;todos&#125;/&gt;</div><div class="line">        &lt;Footer/&gt;</div><div class="line">    &lt;<span class="regexp">/section&gt;</span></div><div class="line"><span class="regexp">);</span></div></pre></td></tr></table></figure>
<p><strong>AddTodo.js</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> AddTodo = <span class="function"><span class="params">()</span> =&gt;</span> (</div><div class="line">    &lt;header className=<span class="string">"header"</span>&gt;</div><div class="line">        &lt;h1&gt;Todos&lt;<span class="regexp">/h1&gt;</span></div><div class="line"><span class="regexp">        &lt;input className="new-todo" placeholder="接下来做什么？" autoFocus /</span>&gt;</div><div class="line">    &lt;<span class="regexp">/header&gt;</span></div><div class="line"><span class="regexp">);</span></div></pre></td></tr></table></figure>
<p><strong>TodoList.js</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> TodoList = <span class="function">(<span class="params">&#123; todos &#125;</span>) =&gt;</span> (</div><div class="line">    &lt;ul className=<span class="string">"todo-list"</span>&gt;</div><div class="line">        &#123;todos.map(<span class="function">(<span class="params">todo</span>) =&gt;</span> (</div><div class="line">            &lt;Todo key=&#123;todo.id&#125; content=&#123;todo.content&#125; /&gt;</div><div class="line">        ))&#125;</div><div class="line">    &lt;<span class="regexp">/ul&gt;</span></div><div class="line"><span class="regexp">);</span></div></pre></td></tr></table></figure>
<p><strong>Todo.js</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> Todo = <span class="function">(<span class="params">&#123; content &#125;</span>) =&gt;</span> (</div><div class="line">    &lt;li&gt;</div><div class="line">        &lt;div className=<span class="string">"view"</span>&gt;</div><div class="line">            &lt;input className=<span class="string">"toggle"</span> type=<span class="string">"checkbox"</span> /&gt;</div><div class="line">            &lt;label href=<span class="string">"/#"</span>&gt;&#123;content&#125;&lt;<span class="regexp">/label&gt;</span></div><div class="line"><span class="regexp">        &lt;/</span>div&gt;</div><div class="line">    &lt;<span class="regexp">/li&gt; </span></div><div class="line"><span class="regexp">);</span></div></pre></td></tr></table></figure>
<p><strong>Foot.js</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> Footer = <span class="function"><span class="params">()</span> =&gt;</span> (</div><div class="line">    &lt;footer className=<span class="string">"footer"</span>&gt;</div><div class="line">        &lt;ul className=<span class="string">"filters"</span>&gt;</div><div class="line">            &lt;Link filter=<span class="string">"all"</span>&gt;</div><div class="line">                全部</div><div class="line">            &lt;<span class="regexp">/Link&gt;</span></div><div class="line"><span class="regexp">            &lt;Link filter="active"&gt;</span></div><div class="line"><span class="regexp">                待办</span></div><div class="line"><span class="regexp">            &lt;/</span>Link&gt;</div><div class="line">            &lt;Link filter=<span class="string">"completed"</span>&gt;</div><div class="line">                已完成</div><div class="line">            &lt;<span class="regexp">/Link&gt;</span></div><div class="line"><span class="regexp">        &lt;/u</span>l&gt;</div><div class="line">    &lt;<span class="regexp">/footer&gt;</span></div><div class="line"><span class="regexp">);</span></div></pre></td></tr></table></figure>
<p>在TodoApp.js中引入todomvc-app-css文件</p>
<p><strong>TodoApp.js</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> <span class="string">'todomvc-app-css/index.css'</span>;</div></pre></td></tr></table></figure>
<h3 id="数据处理"><a href="#数据处理" class="headerlink" title="数据处理"></a>数据处理</h3><p>首先为项目安置redux及react-redux，新建action.js、reducer.js、store.js</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install redux react-redux --save</div></pre></td></tr></table></figure>
<p><strong>action.js</strong></p>
<p>action是一个具有type属性的js对象。我们为其添加一个addTodo功能，更具用户的文本输入，添加一条待办事项。由于待办事项是在react列表中渲染，所以每一项内容都需要一个数据作为key值，定义为todoId 处始为 4（默认有3条）。toggleTodo方法为标记待办事项，我们必须要传递进id即可。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> todoId = <span class="number">4</span>;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> addTodo = <span class="function">(<span class="params">content</span>) =&gt;</span> (&#123;</div><div class="line">    type: <span class="string">'ADD_TODO'</span>,</div><div class="line">    content,</div><div class="line">    id: todoId++</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> toggleTodo = <span class="function">(<span class="params">id</span>) =&gt;</span> (&#123;</div><div class="line">    type: <span class="string">'TOGGLE_TODO'</span>,</div><div class="line">    id</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p><strong>reducer.js</strong></p>
<p>reducer是一个switch结构的函数，接收state和action作为参数，判断不同的action.type的类型，返回一个新的state。当action.type === ‘ADD_TODO’的时候，我们为用户新增一条代办事项，用展开操作符号的方法(…state)，可以保证我们返回的是一个新的state数据。当action === ‘TOGGLE_TODO’ 时，当某一个待办事项切换时，将它切换为已完成或者未完成的状态，然后返回。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> todo = <span class="function">(<span class="params">state, action</span>) =&gt;</span> &#123;</div><div class="line">  <span class="keyword">switch</span> (action.type) &#123;</div><div class="line">    <span class="keyword">case</span> <span class="string">'ADD_TODO'</span>:</div><div class="line">      <span class="keyword">return</span> &#123;</div><div class="line">        id: action.id,</div><div class="line">        content: action.content,</div><div class="line">        completed: <span class="literal">false</span></div><div class="line">      &#125;;</div><div class="line">    <span class="keyword">case</span> <span class="string">'TOGGLE_TODO'</span>:</div><div class="line">      <span class="keyword">if</span> (state.id !== action.id) &#123;</div><div class="line">        <span class="keyword">return</span> state;</div><div class="line">      &#125;;</div><div class="line"></div><div class="line">      <span class="keyword">return</span> &#123;</div><div class="line">        ...state,</div><div class="line">        completed: !state.completed</div><div class="line">      &#125;;</div><div class="line">    <span class="keyword">default</span>:</div><div class="line">      <span class="keyword">return</span> state;</div><div class="line">  &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> todos = <span class="function">(<span class="params">state = [], action</span>) =&gt;</span> &#123;</div><div class="line">    <span class="keyword">switch</span> (action.type) &#123;</div><div class="line">        <span class="keyword">case</span> <span class="string">'ADD_TODO'</span>:</div><div class="line">            <span class="keyword">return</span> [</div><div class="line">                ...state,</div><div class="line">                todo(<span class="literal">undefined</span>, action)</div><div class="line">            ];</div><div class="line">        <span class="keyword">case</span> <span class="string">'TOGGLE_TODO'</span>:</div><div class="line">            <span class="keyword">return</span> state.map(<span class="function"><span class="params">t</span> =&gt;</span> &#123;</div><div class="line">                <span class="keyword">return</span> todo(t, action)</div><div class="line">            &#125;)</div><div class="line">        <span class="keyword">default</span>:</div><div class="line">            <span class="keyword">return</span> state;</div><div class="line">    &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p><strong>store</strong></p>
<p>引用redux调用createStore生成stroe。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; todos &#125; <span class="keyword">from</span> <span class="string">'./reducer'</span>;</div><div class="line"><span class="keyword">import</span> &#123; createStore &#125; <span class="keyword">from</span> <span class="string">'redux'</span>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> defaultTodos = [</div><div class="line">    &#123; </div><div class="line">        id: <span class="number">1</span>,</div><div class="line">        content: <span class="string">"学习 React"</span></div><div class="line">    &#125;,</div><div class="line">    &#123; </div><div class="line">        id: <span class="number">2</span>,</div><div class="line">        content: <span class="string">"学习 Redux"</span></div><div class="line">    &#125;,</div><div class="line">    &#123; </div><div class="line">        id: <span class="number">3</span>,</div><div class="line">        content: <span class="string">"学习 react-router"</span></div><div class="line">    &#125;,</div><div class="line">];</div><div class="line"></div><div class="line"><span class="keyword">const</span> store = createStore(todos, defaultTodos);</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> store;</div></pre></td></tr></table></figure>
<p>为了区分逻辑，新建Root.js。使用react-redux把react和redux连接在一起。</p>
<p>Root.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"><span class="keyword">import</span> &#123; Provider &#125; <span class="keyword">from</span> <span class="string">'react-redux'</span>;</div><div class="line"><span class="keyword">import</span> TodoApp <span class="keyword">from</span> <span class="string">'./TodoApp'</span>;</div><div class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">'../store'</span>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> Root = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">       &lt;Provider store=&#123;store&#125;&gt;</div><div class="line">           &lt;TodoApp /&gt;</div><div class="line">        &lt;<span class="regexp">/Provider&gt;</span></div><div class="line"><span class="regexp">    );</span></div><div class="line"><span class="regexp">&#125;;</span></div><div class="line"><span class="regexp"></span></div><div class="line"><span class="regexp">export default Root;</span></div></pre></td></tr></table></figure>
<p>之前编写的组件都是展示组件，只负责页面的结构，要获取用户数据需要使用的容器组件。在Containers中创建一个VisibleTodoList.js，作为TodoList的容器组件。除了引入TodoList之外，还有引入react-redux中的connect方法，connect的作用就是将store当中的数据和方法，映射到我们组件的props当中。connect方法接收2个函数，mapStateToProps和mapDispatchToProps。分别用来处理store当中的state数据和dispatch方法。这里我们使用简单的mapStateToProps方法，将state数据映射到todos当中。</p>
<p><strong>VisibleTodoList.js</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; connect &#125; <span class="keyword">from</span> <span class="string">'react-redux'</span>;</div><div class="line"><span class="keyword">import</span> TodoList <span class="keyword">from</span> <span class="string">'../Components/TodoList'</span>;</div><div class="line"><span class="keyword">import</span> &#123; toggleTodo &#125; <span class="keyword">from</span> <span class="string">'../action'</span>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> mapStateToProps = <span class="function">(<span class="params">state, ownProps</span>) =&gt;</span> (&#123;</div><div class="line">    todos: state</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="keyword">const</span> mapDispatchToProps = <span class="function">(<span class="params">dispatch</span>) =&gt;</span> (&#123;</div><div class="line">    onTodoClick: <span class="function">(<span class="params">id</span>) =&gt;</span> &#123;</div><div class="line">        dispatch(toggleTodo(id));</div><div class="line">    &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="keyword">const</span> VisibleTodoList = connect(</div><div class="line">    mapStateToProps,</div><div class="line">    mapDispatchToProps</div><div class="line">)(TodoList);</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> VisibleTodoList;</div></pre></td></tr></table></figure>
<p>通过<strong>todoList</strong>为每个todo组件传入onClick方法</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"><span class="keyword">import</span> Todo <span class="keyword">from</span> <span class="string">'./Todo'</span>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> TodoList = <span class="function">(<span class="params">&#123; todos, onTodoClick &#125;</span>) =&gt;</span> (</div><div class="line">    &lt;ul className=<span class="string">"todo-list"</span>&gt;</div><div class="line">        &#123;todos.map(<span class="function">(<span class="params">todo</span>) =&gt;</span> (</div><div class="line">            &lt;Todo key=&#123;todo.id&#125; onClick=&#123;() =&gt; onTodoClick(todo.id)&#125; &#123;...todo&#125; content=&#123;todo.content&#125; /&gt;</div><div class="line">        ))&#125;</div><div class="line">    &lt;<span class="regexp">/ul&gt;</span></div><div class="line"><span class="regexp">);</span></div><div class="line"><span class="regexp"></span></div><div class="line"><span class="regexp">export default TodoList;</span></div></pre></td></tr></table></figure>
<p>然后在<strong>todo</strong>组件中，把事件绑定在checkbox上。我们也需要界面的改变来观察数据的切换，因此我们把checkbox的选中状态和completed的属性绑定在一起，同时为todo组件加上css效果。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> Todo = <span class="function">(<span class="params">&#123; content, onClick, completed &#125;</span>) =&gt;</span> (</div><div class="line">    &lt;li style=&#123;&#123;</div><div class="line">        textDecoration:</div><div class="line">            completed ?</div><div class="line">            <span class="string">'line-through'</span> :</div><div class="line">            <span class="string">'none'</span>,</div><div class="line">        color:</div><div class="line">            completed ?</div><div class="line">            <span class="string">'#d9d9d9'</span> :</div><div class="line">            <span class="string">'#4d4d4d'</span></div><div class="line">        &#125;</div><div class="line">    &#125;&gt;</div><div class="line">        &lt;div className=<span class="string">"view"</span>&gt;</div><div class="line">            &lt;input onChange=&#123;onClick&#125; className=<span class="string">"toggle"</span> type=<span class="string">"checkbox"</span> checked=&#123;completed ? <span class="string">'checked'</span> : <span class="string">''</span>&#125; /&gt;</div><div class="line">            &lt;label href=<span class="string">"/#"</span>&gt;&#123;content&#125;&lt;<span class="regexp">/label&gt;</span></div><div class="line"><span class="regexp">        &lt;/</span>div&gt;</div><div class="line">    &lt;<span class="regexp">/li&gt; </span></div><div class="line"><span class="regexp">);</span></div><div class="line"><span class="regexp"></span></div><div class="line"><span class="regexp">export default Todo;</span></div></pre></td></tr></table></figure>
<p>为AddTodo添加待办事项的功能，把AddTodo移动到Containers当中，引入react-redux中的connect方法。如果我们不为connect传递任何参数，connect会把state和dispatch传递到我们的组件当中，所以我们能从props中获取dispatch方法。为input绑定事件处理函数，当我们按下回车的时候，触发dispatch方法传入ADD_TODO动作（从action中引入ADD_TODO方法）。我们使用非受控组件的方法来获取input的输入值，所以需要在组件中添加ref的属性来获取到input元素，把它暂存到我们声明的input变量当中。</p>
<p><strong>AddTodo.js</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"><span class="keyword">import</span> &#123; connect &#125; <span class="keyword">from</span> <span class="string">'react-redux'</span>;</div><div class="line"><span class="keyword">import</span> &#123; addTodo &#125; <span class="keyword">from</span> <span class="string">'../action'</span>;</div><div class="line"></div><div class="line"><span class="keyword">let</span> AddTodo = <span class="function">(<span class="params">&#123;dispatch&#125;</span>) =&gt;</span> &#123;</div><div class="line">    <span class="keyword">let</span> input</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">        &lt;header className=<span class="string">"header"</span>&gt;</div><div class="line">            &lt;h1&gt;Todos&lt;<span class="regexp">/h1&gt;</span></div><div class="line"><span class="regexp">            &lt;input onKeyDown=&#123;(e) =&gt; &#123;</span></div><div class="line"><span class="regexp">                    if (input.value &amp;&amp; e.keyCode === 13) &#123;</span></div><div class="line"><span class="regexp">                        dispatch(addTodo(input.value))</span></div><div class="line"><span class="regexp">                        input.value = ''</span></div><div class="line"><span class="regexp">                    &#125;</span></div><div class="line"><span class="regexp">                    &#125;&#125;</span></div><div class="line"><span class="regexp">                    ref=&#123;node =&gt; input = node&#125;</span></div><div class="line"><span class="regexp">            className="new-todo" placeholder="接下来做什么？" autoFocus /</span>&gt;</div><div class="line">        &lt;<span class="regexp">/header&gt;</span></div><div class="line"><span class="regexp">    )</span></div><div class="line"><span class="regexp">&#125;;</span></div><div class="line"><span class="regexp"></span></div><div class="line"><span class="regexp">AddTodo = connect()(AddTodo)</span></div><div class="line"><span class="regexp"></span></div><div class="line"><span class="regexp">export default AddTodo;</span></div></pre></td></tr></table></figure>
<p>修改入口主文件<strong>TodoApp.js</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React    <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"></div><div class="line"><span class="keyword">import</span> AddTodo  <span class="keyword">from</span> <span class="string">'../Containers/AddTodo'</span>;</div><div class="line"><span class="keyword">import</span> VisibleTodoList <span class="keyword">from</span> <span class="string">'../Containers/VisibleTodoList'</span>;</div><div class="line"><span class="keyword">import</span> Footer   <span class="keyword">from</span> <span class="string">'./Footer'</span>;</div><div class="line"><span class="keyword">import</span> todos    <span class="keyword">from</span> <span class="string">'../store.js'</span>;</div><div class="line"></div><div class="line"><span class="keyword">import</span> <span class="string">'todomvc-app-css/index.css'</span>;</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">const</span> TodoApp = <span class="function"><span class="params">()</span> =&gt;</span> (</div><div class="line">    &lt;section className=<span class="string">"todoapp"</span>&gt;</div><div class="line">        &lt;AddTodo/&gt;</div><div class="line">        &lt;VisibleTodoList/&gt;</div><div class="line">        &lt;Footer/&gt;</div><div class="line">    &lt;<span class="regexp">/section&gt;</span></div><div class="line"><span class="regexp">);</span></div><div class="line"><span class="regexp"></span></div><div class="line"><span class="regexp">export default TodoApp;</span></div></pre></td></tr></table></figure>
<p>修改渲染文件index.js，让其渲染最外层的<strong>Root.js</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"><span class="keyword">import</span> ReactDOM <span class="keyword">from</span> <span class="string">'react-dom'</span>;</div><div class="line"><span class="keyword">import</span> Root <span class="keyword">from</span> <span class="string">'./Components/Root'</span>;</div><div class="line"></div><div class="line">ReactDOM.render(<span class="xml"><span class="tag">&lt;<span class="name">Root</span> /&gt;</span>, document.getElementById('root'));</span></div></pre></td></tr></table></figure>
<h3 id="路由配置"><a href="#路由配置" class="headerlink" title="路由配置"></a>路由配置</h3><p>react 实现路由需要用到前端路由的技术，这里我们使用react-router4.0。我们需要用到导航的信息，来显示何种待办事项，所以我们以路由参数来设置路径，显示所有待办事项在根路径。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install react-router react-router-dom --save</div></pre></td></tr></table></figure>
<p>在<strong>Root.js</strong>中引入react-router，需要用到的组件有 BrowserRouter 和 Route。然后放置在Provider组件之内。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"><span class="keyword">import</span> &#123; Provider &#125; <span class="keyword">from</span> <span class="string">'react-redux'</span>;</div><div class="line"><span class="keyword">import</span> &#123;</div><div class="line">    BrowserRouter <span class="keyword">as</span> Router,</div><div class="line">    Route</div><div class="line">&#125; <span class="keyword">from</span> <span class="string">'react-router-dom'</span>;</div><div class="line"><span class="keyword">import</span> TodoApp <span class="keyword">from</span> <span class="string">'./TodoApp'</span>;</div><div class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">'../store'</span>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> Root = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">       &lt;Provider store=&#123;store&#125;&gt;</div><div class="line">           &lt;Router&gt;</div><div class="line">               &lt;Route path=<span class="string">'/:filter?'</span> component=&#123;TodoApp&#125;/&gt;</div><div class="line">           &lt;<span class="regexp">/Router&gt;</span></div><div class="line"><span class="regexp">        &lt;/</span>Provider&gt;</div><div class="line">    );</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> Root;</div></pre></td></tr></table></figure>
<p>在底部导航<strong>Link.js</strong>组件中，我们需要把底部导航加上NavLink组件，并把filter参数传递到to属性当中。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"><span class="keyword">import</span> &#123; NavLink &#125; <span class="keyword">from</span> <span class="string">'react-router-dom'</span>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> Link = <span class="function">(<span class="params">&#123; filter, children &#125;</span>) =&gt;</span> (</div><div class="line">    &lt;li&gt;</div><div class="line">        &lt;NavLink to=&#123;<span class="string">"/"</span> + filter&#125;&gt;&#123;children&#125;&lt;<span class="regexp">/NavLink&gt;</span></div><div class="line"><span class="regexp">    &lt;/</span>li&gt;</div><div class="line">);</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> Link;</div></pre></td></tr></table></figure>
<p>在src创建<strong>Selector.js</strong>，selector结构和reducer很像，但不会改变应用更改的数据状态，更具传入的参数返回state的部分内容。selector接收2个参数，state和filter。同样也是switc的结构，更具不同的filter类型处理返回新的state数据。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> getVisibleTodos = <span class="function">(<span class="params">state, filter</span>) =&gt;</span> &#123;</div><div class="line">    <span class="keyword">switch</span>(filter) &#123;</div><div class="line">        <span class="keyword">case</span> <span class="string">'all'</span>:</div><div class="line">            <span class="keyword">return</span> state;</div><div class="line">        <span class="keyword">case</span> <span class="string">'active'</span>:</div><div class="line">            <span class="keyword">return</span> state.filter(<span class="function"><span class="params">t</span> =&gt;</span> !t.completed);</div><div class="line">        <span class="keyword">case</span> <span class="string">'completed'</span>:</div><div class="line">            <span class="keyword">return</span> state.filter(<span class="function"><span class="params">t</span> =&gt;</span> t.completed);</div><div class="line">        <span class="keyword">default</span>:</div><div class="line">            <span class="keyword">return</span> state;</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> getVisibleTodos;</div></pre></td></tr></table></figure>
<p>在<strong>VisibleTodoList.js</strong>中，我们需要使用到路由的参数，并且需要通过路由的信息，重新切换展示出待办事项。所以我们要使用withRouter来生成新的容器组件。reater-router完全兼容redux，只需要在redux的connect外面套上即可。引入我们已经编写号的selector，修改mapStateToProps,将todo设置为被selector设置过滤后的值。这里我们需要使用到保存在match对象中的路由参数，并设置默认值为all。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; connect &#125; <span class="keyword">from</span> <span class="string">'react-redux'</span>;</div><div class="line"><span class="keyword">import</span> &#123; withRouter &#125; <span class="keyword">from</span> <span class="string">'react-router'</span>;</div><div class="line"><span class="keyword">import</span> TodoList <span class="keyword">from</span> <span class="string">'../Components/TodoList'</span>;</div><div class="line"><span class="keyword">import</span> &#123; toggleTodo &#125; <span class="keyword">from</span> <span class="string">'../action'</span>;</div><div class="line"><span class="keyword">import</span> getVisibleTodos <span class="keyword">from</span> <span class="string">'../selector'</span>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> mapStateToProps = <span class="function">(<span class="params">state, &#123;match&#125;</span>) =&gt;</span> (&#123;</div><div class="line">    todos: getVisibleTodos(</div><div class="line">        state,</div><div class="line">        match.params.filter || <span class="string">"all"</span></div><div class="line">    )</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="keyword">const</span> mapDispatchToProps = <span class="function">(<span class="params">dispatch</span>) =&gt;</span> (&#123;</div><div class="line">    onTodoClick: <span class="function">(<span class="params">id</span>) =&gt;</span> &#123;</div><div class="line">        dispatch(toggleTodo(id));</div><div class="line">    &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="keyword">const</span> VisibleTodoList = withRouter(connect(</div><div class="line">    mapStateToProps,</div><div class="line">    mapDispatchToProps</div><div class="line">)(TodoList));</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> VisibleTodoList;</div></pre></td></tr></table></figure>
<p>小结：</p>
<p>我们建立了2个文件夹，Components和Containers，展示组件负责界面的结构样式，容器组件负责处理数据交互，这样可以更好的理清我们业务的逻辑，也方便开发维护。接下来我们使用redux来进行应用的状态管理，我们使用三个独立的文件来处理应用状态数据 action.js 、reducer.js、store.js。action对应这我们页面的每一个功能，这里我们主要实现了添加事项和标记事项是否完成的状态的功能，reducer中一个处理数组中的数据和另一个负责处理单独的todo对象，通过createStore的方法生成store。使用react-router实现前端路由的功能，最常使用的组件BrowserRouter、Route、Link。为了切换显示不同状态的效果，我们还使用到了路由参数，通过withRouter的方法传递到目标组件的方法当中，通过match对象里获取到具体的路由参数。拿到路由参数后，通过redux的selector方法来有选择性的展示数据。</p>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2016/10/10/cssjm2/" rel="next" title="CSS 揭秘（二）形状">
                <i class="fa fa-chevron-left"></i> CSS 揭秘（二）形状
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/avatar.jpg"
                alt="JaxChu" />
            
              <p class="site-author-name" itemprop="name">JaxChu</p>
              <p class="site-description motion-element" itemprop="description">FE@JKXY</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">19</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">5</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">19</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          

          <div class="links-of-author motion-element">
            
          </div>

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#概述"><span class="nav-number">1.</span> <span class="nav-text">概述</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#环境搭建"><span class="nav-number">2.</span> <span class="nav-text">环境搭建</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#组建开发"><span class="nav-number">3.</span> <span class="nav-text">组建开发</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#JSX入门"><span class="nav-number">3.1.</span> <span class="nav-text">JSX入门</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#组件"><span class="nav-number">3.2.</span> <span class="nav-text">组件</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#元素与组件-Element-amp-Component"><span class="nav-number">3.2.1.</span> <span class="nav-text">元素与组件 Element & Component</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#React元素"><span class="nav-number">3.2.1.1.</span> <span class="nav-text">React元素</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#组件-1"><span class="nav-number">3.2.1.2.</span> <span class="nav-text">组件</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#函数定义与类定义组件-Functional-amp-Class"><span class="nav-number">3.2.2.</span> <span class="nav-text">函数定义与类定义组件 Functional & Class</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#展示与容器组件-Presentational-amp-Container"><span class="nav-number">3.2.3.</span> <span class="nav-text">展示与容器组件 Presentational & Container</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#有状态与无状态组件-Stateful-amp-Stateless"><span class="nav-number">3.2.4.</span> <span class="nav-text">有状态与无状态组件 Stateful & Stateless</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#受控与非受控组件-Controlled-amp-Uncontrolled"><span class="nav-number">3.2.5.</span> <span class="nav-text">受控与非受控组件 Controlled & Uncontrolled</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#组合与继承-Composition-amp-Inheritance"><span class="nav-number">3.2.6.</span> <span class="nav-text">组合与继承 Composition & Inheritance</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#组件数据"><span class="nav-number">3.3.</span> <span class="nav-text">组件数据</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Props"><span class="nav-number">3.3.1.</span> <span class="nav-text">Props</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#State"><span class="nav-number">3.3.2.</span> <span class="nav-text">State</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#context"><span class="nav-number">3.3.3.</span> <span class="nav-text">context</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#组件生命周期"><span class="nav-number">3.4.</span> <span class="nav-text">组件生命周期</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#React-是如何渲染组件的？"><span class="nav-number">3.4.1.</span> <span class="nav-text">React 是如何渲染组件的？</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#表单及事件处理"><span class="nav-number">3.5.</span> <span class="nav-text">表单及事件处理</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Redux-数据处理"><span class="nav-number">4.</span> <span class="nav-text">Redux 数据处理</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Redux简介"><span class="nav-number">4.1.</span> <span class="nav-text">Redux简介</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Action"><span class="nav-number">4.2.</span> <span class="nav-text">Action</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Reducer"><span class="nav-number">4.3.</span> <span class="nav-text">Reducer</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Store"><span class="nav-number">4.4.</span> <span class="nav-text">Store</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Middleware"><span class="nav-number">4.5.</span> <span class="nav-text">Middleware</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#react-redux"><span class="nav-number">4.6.</span> <span class="nav-text">react-redux</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#react-router-4"><span class="nav-number">5.</span> <span class="nav-text">react-router 4</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#简介"><span class="nav-number">5.1.</span> <span class="nav-text">简介</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#配置"><span class="nav-number">5.2.</span> <span class="nav-text">配置</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#BrowserRouter"><span class="nav-number">5.2.1.</span> <span class="nav-text">BrowserRouter</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Route"><span class="nav-number">5.2.2.</span> <span class="nav-text">Route</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Link"><span class="nav-number">5.2.3.</span> <span class="nav-text">Link</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#CSS"><span class="nav-number">6.</span> <span class="nav-text">CSS</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#css样式编写的方法"><span class="nav-number">6.1.</span> <span class="nav-text">css样式编写的方法</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Modules-Sass-PostCSS-在React项目中的应用"><span class="nav-number">6.1.1.</span> <span class="nav-text">Modules/Sass/PostCSS 在React项目中的应用</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Modules"><span class="nav-number">6.1.2.</span> <span class="nav-text">Modules</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#sass"><span class="nav-number">6.1.3.</span> <span class="nav-text">sass</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#postcss"><span class="nav-number">6.1.4.</span> <span class="nav-text">postcss</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#实战TodoList"><span class="nav-number">7.</span> <span class="nav-text">实战TodoList</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#开发前准备"><span class="nav-number">7.1.</span> <span class="nav-text">开发前准备</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#组件开发"><span class="nav-number">7.2.</span> <span class="nav-text">组件开发</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#样式"><span class="nav-number">7.3.</span> <span class="nav-text">样式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#数据处理"><span class="nav-number">7.4.</span> <span class="nav-text">数据处理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#路由配置"><span class="nav-number">7.5.</span> <span class="nav-text">路由配置</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">JaxChu</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.3</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.3"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.3"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.3"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	





  





  












  





  

  

  
  

  

  

  

</body>
</html>
